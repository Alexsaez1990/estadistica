<!DOCTYPE html>
<!-- saved from url=(0104)file:///C:/Users/Conaf/Documents/BootCamp/estadistica/Pr%C3%A1ctica/practicafinal_enresoluci%C3%B3n.html -->
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8">


<meta name="generator" content="quarto-1.2.335">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>practicafinal_enresolución</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1.6em;
  vertical-align: middle;
}
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


<script src="./AlejandroSáez-PracticaFinal_files/clipboard.min.js.descarga"></script>
<script src="./AlejandroSáez-PracticaFinal_files/quarto.js.descarga"></script>
<script src="./AlejandroSáez-PracticaFinal_files/popper.min.js.descarga"></script>
<script src="./AlejandroSáez-PracticaFinal_files/tippy.umd.min.js.descarga"></script>
<script src="./AlejandroSáez-PracticaFinal_files/anchor.min.js.descarga"></script>
<link href="./AlejandroSáez-PracticaFinal_files/tippy.css" rel="stylesheet">
<link href="./AlejandroSáez-PracticaFinal_files/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="./AlejandroSáez-PracticaFinal_files/bootstrap.min.js.descarga"></script>
<link href="./AlejandroSáez-PracticaFinal_files/bootstrap-icons.css" rel="stylesheet">
<link href="./AlejandroSáez-PracticaFinal_files/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">


</head>

<body class="fullcontent quarto-light">

<div id="quarto-content" class="page-columns page-rows-contents page-layout-article">

<main class="content" id="quarto-document-content">



<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="http://localhost:6551/#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Cargar los datos en un dataframe llamado: airbnb</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="http://localhost:6551/#cb2-1" aria-hidden="true" tabindex="-1"></a>airbnb<span class="ot">&lt;-</span><span class="fu">read.csv</span>(<span class="st">'data//airbnb.csv'</span>,<span class="at">sep =</span> <span class="st">','</span>, <span class="at">stringsAsFactors =</span> T)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Mostrar las primeras 6 filas del dataframe</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="http://localhost:6551/#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(airbnb, <span class="dv">6</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  Zipcode Neighbourhood.Cleansed Property.Type       Room.Type Accommodates
1   28004            Universidad     Apartment    Private room            2
2   28004            Universidad     Apartment Entire home/apt            6
3   28004            Universidad     Apartment Entire home/apt            3
4   28004            Universidad          Loft Entire home/apt            3
5   28015            Universidad     Apartment Entire home/apt            5
6   28004            Universidad     Apartment Entire home/apt            2
  Bathrooms Bedrooms Beds Bed.Type
1         2        1    1 Real Bed
2         1        3    5 Real Bed
3         1        2    2 Real Bed
4         2        1    1 Real Bed
5         1        1    1 Real Bed
6         1        0    1 Real Bed
                                                                                                                                                                                                                                                                                                                                                         Amenities
1                                                                                                                                                                              TV,Wireless Internet,Kitchen,Pets allowed,Pets live on this property,Buzzer/wireless intercom,Heating,Suitable for events,Washer,First aid kit,Essentials,Lock on bedroom door,Iron
2                                                                                                                                                                                      TV,Internet,Wireless Internet,Air conditioning,Kitchen,Indoor fireplace,Heating,Family/kid friendly,Washer,Dryer,Smoke detector,Carbon monoxide detector,Essentials,Shampoo
3                                                                                                                                                                                           TV,Internet,Wireless Internet,Air conditioning,Kitchen,Doorman,Heating,Family/kid friendly,Washer,Essentials,Shampoo,Hangers,Hair dryer,Iron,Laptop friendly workspace
4                                           TV,Internet,Wireless Internet,Air conditioning,Kitchen,Pets allowed,Breakfast,Elevator in building,Indoor fireplace,Buzzer/wireless intercom,Heating,Washer,Essentials,Shampoo,Hangers,Hair dryer,Iron,Laptop friendly workspace,translation missing: en.hosting_amenity_49,translation missing: en.hosting_amenity_50
5                                                                                                                                                                                                               TV,Wireless Internet,Air conditioning,Kitchen,Smoking allowed,Pets allowed,Elevator in building,Heating,Family/kid friendly,Washer,Essentials,Iron
6 TV,Cable TV,Internet,Wireless Internet,Air conditioning,Wheelchair accessible,Kitchen,Doorman,Elevator in building,Buzzer/wireless intercom,Heating,Washer,Smoke detector,Carbon monoxide detector,First aid kit,Safety card,Fire extinguisher,Essentials,Shampoo,24-hour check-in,Hangers,Hair dryer,Iron,Laptop friendly workspace,Self Check-In,Doorman Entry
  Square.Feet Price Review.Scores.Rating
1          NA    35                   NA
2          NA    92                   96
3          NA    55                   91
4          NA    60                  100
5         538    75                   90
6          NA    55                   95</code></pre>
</div>
</div>
<p>Renombrar las columnas de la siguiente forma:</p>
<table class="table">
<thead>
<tr class="header">
<th>Nombre original</th>
<th>Nuevo nombre</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Zipcode</td>
<td>CodigoPostal</td>
</tr>
<tr class="even">
<td>Neighbourhood.Cleansed</td>
<td>Barrio</td>
</tr>
<tr class="odd">
<td>Property.Type</td>
<td>TipoPropiedad</td>
</tr>
<tr class="even">
<td>Room.Type</td>
<td>TipoAlquiler</td>
</tr>
<tr class="odd">
<td>Accommodates</td>
<td>MaxOcupantes</td>
</tr>
<tr class="even">
<td>Bathrooms</td>
<td>NumBanyos</td>
</tr>
<tr class="odd">
<td>Bedrooms</td>
<td>NumDormitorios</td>
</tr>
<tr class="even">
<td>Beds</td>
<td>NumCamas</td>
</tr>
<tr class="odd">
<td>Bed.Type</td>
<td>TipoCama</td>
</tr>
<tr class="even">
<td>Amenities</td>
<td>Comodidades</td>
</tr>
<tr class="odd">
<td>Square.Feet</td>
<td>PiesCuadrados</td>
</tr>
<tr class="even">
<td>Price</td>
<td>Precio</td>
</tr>
<tr class="odd">
<td>Review.Scores.Rating</td>
<td>Puntuacion</td>
</tr>
</tbody>
</table>
<div class="cell">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="http://localhost:6551/#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Renombrar las columnas de la siguiente forma:</span></span>
<span id="cb5-2"><a href="http://localhost:6551/#cb5-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-3"><a href="http://localhost:6551/#cb5-3" aria-hidden="true" tabindex="-1"></a>newnames<span class="ot">&lt;-</span><span class="fu">c</span>(<span class="st">"CodigoPostal"</span>,<span class="st">"Barrio"</span>,<span class="st">"TipoPropiedad"</span>,<span class="st">"TipoAlquiler"</span>,<span class="st">"MaxOcupantes"</span>,<span class="st">"NumBanyos"</span>,</span>
<span id="cb5-4"><a href="http://localhost:6551/#cb5-4" aria-hidden="true" tabindex="-1"></a><span class="st">"NumDormitorios"</span>,<span class="st">"NumCamas"</span>,<span class="st">"TipoCama"</span>,<span class="st">"Comodidades"</span>,<span class="st">"PiesCuadrados"</span>,<span class="st">"Precio"</span>,<span class="st">"Puntuacion"</span>)</span>
<span id="cb5-5"><a href="http://localhost:6551/#cb5-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-6"><a href="http://localhost:6551/#cb5-6" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(airbnb) <span class="ot">&lt;-</span> newnames</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Crea una nueva columna llamada MetrosCuadrados a partir de la columna PiesCuadrados.</p>
<p>Ayuda: 1 pie cuadrado son 0,092903 metros cuadrdados</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="http://localhost:6551/#cb6-1" aria-hidden="true" tabindex="-1"></a>airbnb<span class="sc">$</span>MetrosCuadrados <span class="ot">&lt;-</span> airbnb<span class="sc">$</span>PiesCuadrados <span class="sc">*</span> <span class="fl">0.092903</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Miremos el código postal. Es una variable con entradas erroneas. Hay valores como ’‘,’-’ y ‘28’ que deberían ser considerados como NA. Así mismo también debería ser NA todos los que no compiencen por 28, ya que estamos con códigos postales de Madrid</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="http://localhost:6551/#cb7-1" aria-hidden="true" tabindex="-1"></a>airbnb<span class="sc">$</span>CodigoPostal <span class="ot">&lt;-</span> <span class="fu">as.character</span>(airbnb<span class="sc">$</span>CodigoPostal)</span>
<span id="cb7-2"><a href="http://localhost:6551/#cb7-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-3"><a href="http://localhost:6551/#cb7-3" aria-hidden="true" tabindex="-1"></a>airbnb<span class="sc">$</span>CodigoPostal <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(<span class="fu">grepl</span>(<span class="st">' '</span>, airbnb<span class="sc">$</span>CodigoPostal) <span class="sc">|</span> <span class="fu">grepl</span>(<span class="st">'-'</span>, airbnb<span class="sc">$</span>CodigoPostal) <span class="sc">|</span> <span class="fu">substr</span>(airbnb<span class="sc">$</span>CodigoPostal, <span class="dv">1</span>, <span class="dv">2</span>) <span class="sc">!=</span> <span class="st">'28'</span>, <span class="cn">NA</span>, airbnb<span class="sc">$</span>CodigoPostal)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>El código postal 28002, 28004 y 28051 tienen entradas repetidas. Por ejemplo las entradas 28002 deberían ir dentro de 28002</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="http://localhost:6551/#cb8-1" aria-hidden="true" tabindex="-1"></a>airbnb<span class="sc">$</span>CodigoPostal <span class="ot">&lt;-</span> <span class="fu">gsub</span>(<span class="st">'28002.*'</span>, <span class="st">'28002'</span>, airbnb<span class="sc">$</span>CodigoPostal)</span>
<span id="cb8-2"><a href="http://localhost:6551/#cb8-2" aria-hidden="true" tabindex="-1"></a>airbnb<span class="sc">$</span>CodigoPostal <span class="ot">&lt;-</span> <span class="fu">gsub</span>(<span class="st">'28004.*'</span>, <span class="st">'28004'</span>, airbnb<span class="sc">$</span>CodigoPostal)</span>
<span id="cb8-3"><a href="http://localhost:6551/#cb8-3" aria-hidden="true" tabindex="-1"></a>airbnb<span class="sc">$</span>CodigoPostal <span class="ot">&lt;-</span> <span class="fu">gsub</span>(<span class="st">'28051.*'</span>, <span class="st">'28051'</span>, airbnb<span class="sc">$</span>CodigoPostal)</span>
<span id="cb8-4"><a href="http://localhost:6551/#cb8-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-5"><a href="http://localhost:6551/#cb8-5" aria-hidden="true" tabindex="-1"></a><span class="co">#subset(airbnb, grepl('^28002', CodigoPostal))</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>El codigo 2804 debería ser 28004, 2805 deberia ser 28005 y 2815 junto con 2815 debería ser 28015</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="http://localhost:6551/#cb9-1" aria-hidden="true" tabindex="-1"></a>airbnb<span class="sc">$</span>CodigoPostal <span class="ot">&lt;-</span> <span class="fu">gsub</span>(<span class="st">'2804$'</span>, <span class="st">'28004'</span>, airbnb<span class="sc">$</span>CodigoPostal)</span>
<span id="cb9-2"><a href="http://localhost:6551/#cb9-2" aria-hidden="true" tabindex="-1"></a>airbnb<span class="sc">$</span>CodigoPostal <span class="ot">&lt;-</span> <span class="fu">gsub</span>(<span class="st">'2805$'</span>, <span class="st">'28005'</span>, airbnb<span class="sc">$</span>CodigoPostal)</span>
<span id="cb9-3"><a href="http://localhost:6551/#cb9-3" aria-hidden="true" tabindex="-1"></a>airbnb<span class="sc">$</span>CodigoPostal <span class="ot">&lt;-</span> <span class="fu">gsub</span>(<span class="st">'2815$'</span>, <span class="st">'28015'</span>, airbnb<span class="sc">$</span>CodigoPostal)</span>
<span id="cb9-4"><a href="http://localhost:6551/#cb9-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-5"><a href="http://localhost:6551/#cb9-5" aria-hidden="true" tabindex="-1"></a><span class="co">#subset(airbnb, grepl('2804$', CodigoPostal))</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Limpia los datos de la columna Codigo Postal</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="http://localhost:6551/#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Vemos que hay un CP que es '28'. Para terminar tras la limpieza hecha, vamos a dejar como NA aquellos CP que no contengan 5 caracteres:</span></span>
<span id="cb10-2"><a href="http://localhost:6551/#cb10-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-3"><a href="http://localhost:6551/#cb10-3" aria-hidden="true" tabindex="-1"></a>airbnb<span class="sc">$</span>CodigoPostal <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(<span class="fu">nchar</span>(airbnb<span class="sc">$</span>CodigoPostal) <span class="sc">!=</span> <span class="dv">5</span>, <span class="cn">NA</span>, airbnb<span class="sc">$</span>CodigoPostal)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Una vez limpios los datos ¿Cuales son los códigos postales que tenemos?</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="http://localhost:6551/#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="fu">unique</span>(airbnb<span class="sc">$</span>CodigoPostal)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> [1] "28004" "28015" "28013" "28005" "28012" "28014" "28045" NA      "28007"
[10] "28028" "28009" "28001" "28006" "28010" "28002" "28034" "28050" "28008"
[19] "28011" "28049" "28038" "28053" "28047" "28025" "28019" "28024" "28016"
[28] "28036" "28046" "28039" "28020" "28003" "28029" "28054" "28041" "28026"
[37] "28058" "28018" "28030" "28017" "28027" "28043" "28033" "28055" "28021"
[46] "28032" "28037" "28022" "28042" "28094" "28035" "28040" "28031" "28044"
[55] "28105" "28023" "28051" "28850" "28048" "28056" "28060" "28052"</code></pre>
</div>
</div>
<p>¿Cuales son los 5 códigos postales con más entradas? ¿Y con menos? ¿Cuantas entradas tienen?</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="http://localhost:6551/#cb13-1" aria-hidden="true" tabindex="-1"></a>frecuencias <span class="ot">&lt;-</span> <span class="fu">table</span>(airbnb<span class="sc">$</span>CodigoPostal)</span>
<span id="cb13-2"><a href="http://localhost:6551/#cb13-2" aria-hidden="true" tabindex="-1"></a>top5 <span class="ot">&lt;-</span> <span class="fu">head</span>(<span class="fu">sort</span>(frecuencias, <span class="at">decreasing =</span> <span class="cn">TRUE</span>), <span class="dv">5</span>)</span>
<span id="cb13-3"><a href="http://localhost:6551/#cb13-3" aria-hidden="true" tabindex="-1"></a>anti_top5 <span class="ot">&lt;-</span> <span class="fu">head</span>(<span class="fu">sort</span>(frecuencias), <span class="dv">5</span>)</span>
<span id="cb13-4"><a href="http://localhost:6551/#cb13-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-5"><a href="http://localhost:6551/#cb13-5" aria-hidden="true" tabindex="-1"></a>top5_anti_top5 <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">codigo_postal =</span> <span class="fu">c</span>(<span class="fu">names</span>(top5), <span class="fu">names</span>(anti_top5)), </span>
<span id="cb13-6"><a href="http://localhost:6551/#cb13-6" aria-hidden="true" tabindex="-1"></a>                             <span class="at">frecuencia =</span> <span class="fu">c</span>(top5, anti_top5), <span class="at">row.names =</span> <span class="cn">NULL</span>) <span class="co"># Me repetía los códigos postales como rowname, asíque le pongo NULL para que los elimine</span></span>
<span id="cb13-7"><a href="http://localhost:6551/#cb13-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-8"><a href="http://localhost:6551/#cb13-8" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(top5_anti_top5, <span class="dv">10</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>   codigo_postal frecuencia
1          28012       2060
2          28004       1795
3          28005       1195
4          28013       1019
5          28014        630
6          28048          1
7          28052          1
8          28056          1
9          28058          1
10         28060          1</code></pre>
</div>
</div>
<p>¿Cuales son los barrios que hay en el código postal 28012?</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="http://localhost:6551/#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="fu">paste</span>(<span class="fu">unique</span>(airbnb<span class="sc">$</span>Barrio[<span class="fu">which</span>(airbnb<span class="sc">$</span>CodigoPostal <span class="sc">==</span> <span class="st">'28012'</span>)]), <span class="at">collapse =</span> <span class="st">", "</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "Sol, Acacias, Palos de Moguer, Embajadores, Cortes, Palacio, Universidad, Delicias, Arapiles, Atocha, Goya"</code></pre>
</div>
</div>
<p>¿Cuantas entradas hay en cada uno de esos barrios para el codigo postal 28012?</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href="http://localhost:6551/#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="fu">subset</span>(<span class="fu">as.data.frame</span>(<span class="fu">table</span>(airbnb<span class="sc">$</span>Barrio[<span class="fu">which</span>(airbnb<span class="sc">$</span>CodigoPostal <span class="sc">==</span> <span class="st">'28012'</span>)])), Freq <span class="sc">&gt;</span><span class="dv">0</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>               Var1 Freq
2           Acacias   13
14         Arapiles    1
18           Atocha    1
41           Cortes  216
45         Delicias    1
49      Embajadores 1449
56             Goya    1
81          Palacio   27
85  Palos de Moguer   46
112             Sol  301
115     Universidad    4</code></pre>
</div>
</div>
<p>¿Cuantos barrios hay en todo el dataset airbnb? ¿Cuales son?</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb19-1"><a href="http://localhost:6551/#cb19-1" aria-hidden="true" tabindex="-1"></a>num_barrios <span class="ot">&lt;-</span> <span class="fu">length</span>(<span class="fu">unique</span>(airbnb<span class="sc">$</span>Barrio))</span>
<span id="cb19-2"><a href="http://localhost:6551/#cb19-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-3"><a href="http://localhost:6551/#cb19-3" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">paste</span>(<span class="st">"Hay"</span>,num_barrios, <span class="st">"barrios diferentes. Son estos:"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "Hay 125 barrios diferentes. Son estos:"</code></pre>
</div>
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb21-1"><a href="http://localhost:6551/#cb21-1" aria-hidden="true" tabindex="-1"></a><span class="fu">unique</span>(airbnb<span class="sc">$</span>Barrio)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  [1] Universidad                  Sol                         
  [3] Imperial                     Acacias                     
  [5] Chopera                      Delicias                    
  [7] Palos de Moguer              Embajadores                 
  [9] Cortes                       Atocha                      
 [11] Pacífico                     Adelfas                     
 [13] Estrella                     Ibiza                       
 [15] Jerónimos                    Niño Jesús                  
 [17] Palacio                      Justicia                    
 [19] Recoletos                    Goya                        
 [21] Fuente del Berro             Arapiles                    
 [23] Trafalgar                    Almagro                     
 [25] Guindalera                   Lista                       
 [27] Castellana                   El Viso                     
 [29] Prosperidad                  Valverde                    
 [31] Casa de Campo                El Goloso                   
 [33] Numancia                     Cármenes                    
 [35] Puerta del Angel             Lucero                      
 [37] Aluche                       San Isidro                  
 [39] Campamento                   Comillas                    
 [41] Opañel                       Vista Alegre                
 [43] Ciudad Jardín                Hispanoamérica              
 [45] Nueva España                 Castilla                    
 [47] Bellas Vistas                Cuatro Caminos              
 [49] Castillejos                  Vallehermoso                
 [51] Almenara                     Valdeacederas               
 [53] Berruguete                   Gaztambide                  
 [55] Rios Rosas                   Peñagrande                  
 [57] Argüelles                    Puerta Bonita               
 [59] Buenavista                   Abrantes                    
 [61] Orcasur                      San Fermín                  
 [63] Almendrales                  Pradolongo                  
 [65] Portazgo                     Entrevías                   
 [67] San Diego                    Palomeras Bajas             
 [69] Fontarrón                    Vinateros                   
 [71] Ventas                       Pueblo Nuevo                
 [73] Quintana                     Concepción                  
 [75] San Juan Bautista            Costillares                 
 [77] Piovera                      Canillas                    
 [79] Pinar del Rey                Apostol Santiago            
 [81] San Andrés                   Valdefuentes                
 [83] Butarque                     Los Angeles                 
 [85] Casco Histórico de Vicálvaro Simancas                    
 [87] Rejas                        Salvador                    
 [89] Casco Histórico de Barajas   Pilar                       
 [91] La Paz                       Mirasierra                  
 [93] Ciudad Universitaria         Moscardó                    
 [95] Palomeras Sureste            Marroquina                  
 [97] Media Legua                  Los Rosales                 
 [99] Casco Histórico de Vallecas  Timón                       
[101] Corralejos                   Cuatro Vientos              
[103] Colina                       San Cristobal               
[105] Alameda de Osuna             Aeropuerto                  
[107] Palomas                      Zofío                       
[109] Aguilas                      Legazpi                     
[111] Fuentelareina                Aravaca                     
[113] Ambroz                       Canillejas                  
[115] Valdezarza                   Amposta                     
[117] San Pascual                  Santa Eugenia               
[119] Arcos                        Rosas                       
[121] Valdemarín                   El Plantío                  
[123] Hellín                       Pavones                     
[125] Orcasitas                   
125 Levels: Abrantes Acacias Adelfas Aeropuerto Aguilas ... Zofío</code></pre>
</div>
</div>
<p>¿Cuales son los 5 barrios que tienen mayor número entradas?</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb23-1"><a href="http://localhost:6551/#cb23-1" aria-hidden="true" tabindex="-1"></a>frecuencia_barrios <span class="ot">&lt;-</span> <span class="fu">table</span>(airbnb<span class="sc">$</span>Barrio)</span>
<span id="cb23-2"><a href="http://localhost:6551/#cb23-2" aria-hidden="true" tabindex="-1"></a>top5_barrios <span class="ot">&lt;-</span> <span class="fu">head</span>(<span class="fu">sort</span>(frecuencia_barrios, <span class="at">decreasing =</span> <span class="cn">TRUE</span>), <span class="dv">5</span>)</span>
<span id="cb23-3"><a href="http://localhost:6551/#cb23-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-4"><a href="http://localhost:6551/#cb23-4" aria-hidden="true" tabindex="-1"></a>top5_barrios</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Embajadores Universidad     Palacio         Sol    Justicia 
       1844        1358        1083         940         785 </code></pre>
</div>
</div>
<p>¿Cuantos Tipos de Alquiler diferentes hay? ¿Cuales son? ¿Cuantas entradas en el dataframe hay por cada tipo?</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb25-1"><a href="http://localhost:6551/#cb25-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">paste</span>(<span class="st">"Existen"</span>, <span class="fu">unique</span>(<span class="fu">length</span>(<span class="fu">unique</span>(airbnb<span class="sc">$</span>TipoAlquiler))), <span class="st">"tipos de alquiler diferentes, son estos:"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "Existen 3 tipos de alquiler diferentes, son estos:"</code></pre>
</div>
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb27-1"><a href="http://localhost:6551/#cb27-1" aria-hidden="true" tabindex="-1"></a><span class="fu">unique</span>(airbnb<span class="sc">$</span>TipoAlquiler)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] Private room    Entire home/apt Shared room    
Levels: Entire home/apt Private room Shared room</code></pre>
</div>
<div class="sourceCode cell-code" id="cb29"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb29-1"><a href="http://localhost:6551/#cb29-1" aria-hidden="true" tabindex="-1"></a>df_tipo_alquiler <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">TipoAlquiler =</span> <span class="fu">names</span>(<span class="fu">table</span>(airbnb<span class="sc">$</span>TipoAlquiler)),</span>
<span id="cb29-2"><a href="http://localhost:6551/#cb29-2" aria-hidden="true" tabindex="-1"></a>                               <span class="at">Frecuencia =</span> <span class="fu">as.vector</span>(<span class="fu">table</span>(airbnb<span class="sc">$</span>TipoAlquiler)))</span>
<span id="cb29-3"><a href="http://localhost:6551/#cb29-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-4"><a href="http://localhost:6551/#cb29-4" aria-hidden="true" tabindex="-1"></a>df_tipo_alquiler</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>     TipoAlquiler Frecuencia
1 Entire home/apt       7903
2    Private room       5113
3     Shared room        191</code></pre>
</div>
</div>
<p>Muestra el diagrama de cajas del precio para cada uno de los diferentes Tipos de Alquiler</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb31"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb31-1"><a href="http://localhost:6551/#cb31-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(<span class="st">"ggplot2"</span>)</span>
<span id="cb31-2"><a href="http://localhost:6551/#cb31-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(<span class="st">"tidyr"</span>)</span>
<span id="cb31-3"><a href="http://localhost:6551/#cb31-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-4"><a href="http://localhost:6551/#cb31-4" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data=</span><span class="fu">drop_na</span>(airbnb,Precio),<span class="fu">aes</span>(<span class="at">x=</span>TipoAlquiler, <span class="at">y=</span>Precio ,<span class="at">color=</span>TipoAlquiler))<span class="sc">+</span> <span class="co"># Uso drop_na en la llamada al dataframe para evitar el warning de valores infinitos</span></span>
<span id="cb31-5"><a href="http://localhost:6551/#cb31-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>() <span class="sc">+</span></span>
<span id="cb31-6"><a href="http://localhost:6551/#cb31-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Precios por tipo de alquiler"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="./AlejandroSáez-PracticaFinal_files/unnamed-chunk-17-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p><strong>#Este punto todavía no se puede hacer!!!!!!</strong> Cual es el precio medio de alquiler de cada uno, la diferencia que hay ¿es estadísticamente significativa? ¿Con que test lo comprobarías?</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb32"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb32-1"><a href="http://localhost:6551/#cb32-1" aria-hidden="true" tabindex="-1"></a>mean_prices_TipoAlquiler <span class="ot">&lt;-</span> <span class="fu">aggregate</span>(Precio <span class="sc">~</span> TipoAlquiler, <span class="at">data =</span> airbnb, <span class="at">FUN =</span> mean)</span>
<span id="cb32-2"><a href="http://localhost:6551/#cb32-2" aria-hidden="true" tabindex="-1"></a>mean_prices_TipoAlquiler</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>     TipoAlquiler   Precio
1 Entire home/apt 87.29661
2    Private room 34.25514
3     Shared room 29.85340</code></pre>
</div>
<div class="sourceCode cell-code" id="cb34"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb34-1"><a href="http://localhost:6551/#cb34-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Para comprobar si la diferencia es estadísticamente significativa, en primer lugar aplicaremos el test de Saphiro para saber si los valores de cada grupo siguen una distribución gaussiana</span></span>
<span id="cb34-2"><a href="http://localhost:6551/#cb34-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-3"><a href="http://localhost:6551/#cb34-3" aria-hidden="true" tabindex="-1"></a>precios <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(airbnb<span class="sc">$</span>Precio)</span>
<span id="cb34-4"><a href="http://localhost:6551/#cb34-4" aria-hidden="true" tabindex="-1"></a>tipo_alquiler <span class="ot">&lt;-</span> airbnb<span class="sc">$</span>TipoAlquiler</span>
<span id="cb34-5"><a href="http://localhost:6551/#cb34-5" aria-hidden="true" tabindex="-1"></a>precios_entire <span class="ot">&lt;-</span> precios[tipo_alquiler <span class="sc">==</span> <span class="st">"Entire home/apt"</span>]</span>
<span id="cb34-6"><a href="http://localhost:6551/#cb34-6" aria-hidden="true" tabindex="-1"></a>precios_private <span class="ot">&lt;-</span> precios[tipo_alquiler <span class="sc">==</span> <span class="st">"Private room"</span>]</span>
<span id="cb34-7"><a href="http://localhost:6551/#cb34-7" aria-hidden="true" tabindex="-1"></a>precios_shared <span class="ot">&lt;-</span> precios[tipo_alquiler <span class="sc">==</span> <span class="st">"Shared room"</span>]</span>
<span id="cb34-8"><a href="http://localhost:6551/#cb34-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-9"><a href="http://localhost:6551/#cb34-9" aria-hidden="true" tabindex="-1"></a><span class="fu">shapiro.test</span>(<span class="fu">head</span>(precios_entire, <span class="dv">5000</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Shapiro-Wilk normality test

data:  head(precios_entire, 5000)
W = 0.64959, p-value &lt; 2.2e-16</code></pre>
</div>
<div class="sourceCode cell-code" id="cb36"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb36-1"><a href="http://localhost:6551/#cb36-1" aria-hidden="true" tabindex="-1"></a><span class="fu">shapiro.test</span>(<span class="fu">head</span>(precios_private, <span class="dv">5000</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Shapiro-Wilk normality test

data:  head(precios_private, 5000)
W = 0.38267, p-value &lt; 2.2e-16</code></pre>
</div>
<div class="sourceCode cell-code" id="cb38"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb38-1"><a href="http://localhost:6551/#cb38-1" aria-hidden="true" tabindex="-1"></a><span class="fu">shapiro.test</span>(<span class="fu">head</span>(precios_shared, <span class="dv">5000</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Shapiro-Wilk normality test

data:  head(precios_shared, 5000)
W = 0.4436, p-value &lt; 2.2e-16</code></pre>
</div>
<div class="sourceCode cell-code" id="cb40"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb40-1"><a href="http://localhost:6551/#cb40-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Para realizar el test de Saphiro, tomamos como hipótesis nula que los datos tienen una distribución normal o gaussiana. La hipótesis alternativa será en este caso que no poseen una distribución normal</span></span>
<span id="cb40-2"><a href="http://localhost:6551/#cb40-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Si p-value &lt; 0.05 podremos descartar la hipótesis nula y abrazar la hipótesis alternativa. Como p-value &lt; 2.2e-16 en los tres grupos, descartamos la hipótesis nula y aceptamos que NO se trata de una distribución gaussiana. Ahora, aplicaremos el test ANOVA para comparar los tres grupos:</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb41"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb41-1"><a href="http://localhost:6551/#cb41-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Aplicaremos el test Kruskal-Wallis para cualquier distribución, ya que vimos que los datos no formaban una distribución gaussiana al aplicar el test Saphiro.</span></span>
<span id="cb41-2"><a href="http://localhost:6551/#cb41-2" aria-hidden="true" tabindex="-1"></a><span class="co"># La hipótesis nula será que no hay diferencia estadísticamente significativa. Esto se cumplirá si p-value &gt; 0.05</span></span>
<span id="cb41-3"><a href="http://localhost:6551/#cb41-3" aria-hidden="true" tabindex="-1"></a><span class="co"># La hipótesis alternativa será que sí hay diferencia estadísticamente significativa, que los tres grupos son diferentes.</span></span>
<span id="cb41-4"><a href="http://localhost:6551/#cb41-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-5"><a href="http://localhost:6551/#cb41-5" aria-hidden="true" tabindex="-1"></a><span class="fu">kruskal.test</span>(Precio <span class="sc">~</span> TipoAlquiler, airbnb)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Kruskal-Wallis rank sum test

data:  Precio by TipoAlquiler
Kruskal-Wallis chi-squared = 7235.6, df = 2, p-value &lt; 2.2e-16</code></pre>
</div>
<div class="sourceCode cell-code" id="cb43"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb43-1"><a href="http://localhost:6551/#cb43-1" aria-hidden="true" tabindex="-1"></a><span class="co"># El resultado nos dice que p-valor &lt;2e-16, mucho menor a 0.05, con lo que descartamos la hipótesis nula y abrazamos la alternativa, por lo que SÍ hay diferencia estadísticamente significativa.</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Filtra el dataframe cuyos tipo de alquiler sea ‘Entire home/apt’ y guardalo en un dataframe llamado <em>airbnb_entire</em>. Estas serán las entradas que tienen un alquiler del piso completo.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb44"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb44-1"><a href="http://localhost:6551/#cb44-1" aria-hidden="true" tabindex="-1"></a>airbnb_entire <span class="ot">&lt;-</span> airbnb[<span class="fu">which</span>(airbnb<span class="sc">$</span>TipoAlquiler <span class="sc">==</span> <span class="st">'Entire home/apt'</span>),]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>¿Cuales son los 5 barrios que tienen un mayor número de apartamentos enteros en alquiler? Nota: Mirar solo en airbnb_entire. A partir de este punto y hasta que se diga lo contrario partiremos de airbnb_entire.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb45"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb45-1"><a href="http://localhost:6551/#cb45-1" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(<span class="fu">sort</span>(<span class="fu">table</span>(airbnb_entire<span class="sc">$</span>Barrio), <span class="at">decreasing =</span> <span class="cn">TRUE</span>), <span class="dv">5</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Embajadores Universidad     Palacio         Sol      Cortes 
       1228         984         769         701         574 </code></pre>
</div>
</div>
<p>¿Cuales son los 5 barrios que tienen un mayor precio medio de alquiler para apartamentos enteros (es decir, del dataframe airbnb_entire)? ¿Cual es su precio medio? Ayuda: Usa la función aggregate <code>aggregate(.~colname,df,mean,na.rm=TRUE)</code></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb47"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb47-1"><a href="http://localhost:6551/#cb47-1" aria-hidden="true" tabindex="-1"></a>media_barrio <span class="ot">&lt;-</span> <span class="fu">aggregate</span>(Precio <span class="sc">~</span> Barrio, <span class="at">data =</span> airbnb_entire, <span class="at">FUN =</span> mean)</span>
<span id="cb47-2"><a href="http://localhost:6551/#cb47-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-3"><a href="http://localhost:6551/#cb47-3" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(media_barrio[<span class="fu">order</span>(media_barrio<span class="sc">$</span>Precio, <span class="at">decreasing =</span> <span class="cn">TRUE</span>), ], <span class="dv">5</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>          Barrio   Precio
77       Palomas 309.7500
50 Fuentelareina 180.0000
93     Recoletos 161.9254
43    El Plantío 150.0000
30    Castellana 141.3889</code></pre>
</div>
</div>
<p>¿Cuantos apartamentos hay en cada uno de esos barrios? Mostrar un dataframe con el nombre del barrio, el precio y el número de entradas.</p>
<p>Ayuda: Podeis crear un nuevo dataframe con las columnas “Barrio” y “Freq” que contenga el número de entradas en cada barrio y hacer un merge con el dataframe del punto anterior.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb49"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb49-1"><a href="http://localhost:6551/#cb49-1" aria-hidden="true" tabindex="-1"></a>cuenta_barrio <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(<span class="fu">table</span>(airbnb_entire<span class="sc">$</span>Barrio)) <span class="co"># Cuento la cantidad de apariciones de cada barrio en el dataframe</span></span>
<span id="cb49-2"><a href="http://localhost:6551/#cb49-2" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(cuenta_barrio) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"Barrio"</span>, <span class="st">"N_apartamentos"</span>)</span>
<span id="cb49-3"><a href="http://localhost:6551/#cb49-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-4"><a href="http://localhost:6551/#cb49-4" aria-hidden="true" tabindex="-1"></a>apartamentos_barrio <span class="ot">&lt;-</span> <span class="fu">merge</span>(media_barrio, cuenta_barrio, <span class="at">by =</span> <span class="st">"Barrio"</span>) <span class="co">#Combino la cantidad de apariciones por barrio con media_barrio (precio medio por barrio) que he calculado antes</span></span>
<span id="cb49-5"><a href="http://localhost:6551/#cb49-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-6"><a href="http://localhost:6551/#cb49-6" aria-hidden="true" tabindex="-1"></a>top5 <span class="ot">&lt;-</span> <span class="fu">head</span>(apartamentos_barrio[<span class="fu">order</span>(apartamentos_barrio<span class="sc">$</span>Precio, <span class="at">decreasing =</span> <span class="cn">TRUE</span>),], <span class="dv">5</span>) <span class="co"># Muestro los 5 de mayor precio medio de alquiler y su cantidad de apartamentos</span></span>
<span id="cb49-7"><a href="http://localhost:6551/#cb49-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-8"><a href="http://localhost:6551/#cb49-8" aria-hidden="true" tabindex="-1"></a>top5</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>          Barrio   Precio N_apartamentos
77       Palomas 309.7500              4
50 Fuentelareina 180.0000              2
93     Recoletos 161.9254            135
43    El Plantío 150.0000              1
30    Castellana 141.3889             73</code></pre>
</div>
</div>
<p>Partiendo del dataframe anterior, muestra los 5 barrios con mayor precio, pero que tengan más de 100 entradas de alquiler.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb51"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb51-1"><a href="http://localhost:6551/#cb51-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>
Attaching package: 'dplyr'</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following objects are masked from 'package:stats':

    filter, lag</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following objects are masked from 'package:base':

    intersect, setdiff, setequal, union</code></pre>
</div>
<div class="sourceCode cell-code" id="cb55"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb55-1"><a href="http://localhost:6551/#cb55-1" aria-hidden="true" tabindex="-1"></a>significativos_precio <span class="ot">&lt;-</span> <span class="fu">head</span>(apartamentos_barrio[apartamentos_barrio<span class="sc">$</span>N_apartamentos <span class="sc">&gt;</span><span class="dv">100</span>, ] <span class="sc">|&gt;</span> <span class="fu">arrange</span>(<span class="fu">desc</span>(Precio)), <span class="dv">5</span>)</span>
<span id="cb55-2"><a href="http://localhost:6551/#cb55-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-3"><a href="http://localhost:6551/#cb55-3" aria-hidden="true" tabindex="-1"></a>significativos_precio</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>     Barrio    Precio N_apartamentos
1 Recoletos 161.92537            135
2      Goya 111.33803            142
3       Sol 100.75036            701
4 Trafalgar  98.57848            223
5  Justicia  98.25468            534</code></pre>
</div>
</div>
<p>Dibuja el diagrama de densidad de distribución de los diferentes precios. Serían 5 gráficas, una por cada barrio.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb57"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb57-1"><a href="http://localhost:6551/#cb57-1" aria-hidden="true" tabindex="-1"></a>airbnb_entire_top5 <span class="ot">&lt;-</span> airbnb_entire <span class="sc">|&gt;</span> <span class="fu">filter</span>(Barrio <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">"Recoletos"</span>, <span class="st">"Goya"</span>, <span class="st">"Sol"</span>, <span class="st">"Trafalgar"</span>, <span class="st">"Justicia"</span>))</span>
<span id="cb57-2"><a href="http://localhost:6551/#cb57-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb57-3"><a href="http://localhost:6551/#cb57-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb57-4"><a href="http://localhost:6551/#cb57-4" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> <span class="fu">drop_na</span>(airbnb_entire_top5, Precio), <span class="fu">aes</span>(<span class="at">x =</span> Precio, <span class="at">fill =</span> Barrio)) <span class="sc">+</span></span>
<span id="cb57-5"><a href="http://localhost:6551/#cb57-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_density</span>() <span class="sc">+</span></span>
<span id="cb57-6"><a href="http://localhost:6551/#cb57-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span>Barrio, <span class="at">nrow =</span> <span class="dv">3</span>) <span class="sc">+</span> <span class="co"># podríamos utilizar , scales = "free" para que cada diagrama tenga su escala propia, pero en este caso podría ser más conveniente una común</span></span>
<span id="cb57-7"><a href="http://localhost:6551/#cb57-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Precio"</span>, <span class="at">y =</span> <span class="st">"Densidad"</span>, <span class="at">fill =</span> <span class="st">"Barrio"</span>) <span class="sc">+</span></span>
<span id="cb57-8"><a href="http://localhost:6551/#cb57-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_dark</span>() <span class="co"># Cacharreando un poco con los temas</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="./AlejandroSáez-PracticaFinal_files/unnamed-chunk-25-1.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb58"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb58-1"><a href="http://localhost:6551/#cb58-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Vemos como los precios por lo general se agrupan en el rango por debajo de 200 euros, aunque por ejemplo en Recoletos la cola es mucho mayor hacia la derecha </span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Calcula el tamaño medio, en metros cuadrados, para los 5 barrios anteriores y muestralo en el mismo dataframe junto con el precio y número de entradas</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb59"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb59-1"><a href="http://localhost:6551/#cb59-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span>
<span id="cb59-2"><a href="http://localhost:6551/#cb59-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-3"><a href="http://localhost:6551/#cb59-3" aria-hidden="true" tabindex="-1"></a>media_tamano <span class="ot">&lt;-</span> <span class="fu">aggregate</span>(MetrosCuadrados <span class="sc">~</span>Barrio, <span class="at">data =</span> airbnb_entire[airbnb_entire<span class="sc">$</span>Barrio <span class="sc">%in%</span> significativos_precio<span class="sc">$</span>Barrio,], <span class="at">FUN =</span> mean)</span>
<span id="cb59-4"><a href="http://localhost:6551/#cb59-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-5"><a href="http://localhost:6551/#cb59-5" aria-hidden="true" tabindex="-1"></a>top5_media_tamano <span class="ot">&lt;-</span> <span class="fu">merge</span>(significativos_precio, media_tamano, <span class="at">by =</span> <span class="st">"Barrio"</span>)</span>
<span id="cb59-6"><a href="http://localhost:6551/#cb59-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-7"><a href="http://localhost:6551/#cb59-7" aria-hidden="true" tabindex="-1"></a>top5_media_tamano</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>     Barrio    Precio N_apartamentos MetrosCuadrados
1      Goya 111.33803            142        51.68504
2  Justicia  98.25468            534        28.52669
3 Recoletos 161.92537            135        26.66316
4       Sol 100.75036            701        45.61692
5 Trafalgar  98.57848            223        29.30426</code></pre>
</div>
</div>
<p>Dibuja el diagrama de densidad de distribución de los diferentes tamaños de apartamentos. Serían 5 gráficas, una por cada barrio.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb61"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb61-1"><a href="http://localhost:6551/#cb61-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Mismo plot que antes pero para los metros cuadrados</span></span>
<span id="cb61-2"><a href="http://localhost:6551/#cb61-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> <span class="fu">drop_na</span>(airbnb_entire_top5, Precio), <span class="fu">aes</span>(<span class="at">x =</span> MetrosCuadrados, <span class="at">fill =</span> Barrio)) <span class="sc">+</span></span>
<span id="cb61-3"><a href="http://localhost:6551/#cb61-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_density</span>() <span class="sc">+</span></span>
<span id="cb61-4"><a href="http://localhost:6551/#cb61-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span>Barrio, <span class="at">nrow =</span> <span class="dv">3</span>, <span class="at">scales =</span> <span class="st">"free"</span>) <span class="sc">+</span> </span>
<span id="cb61-5"><a href="http://localhost:6551/#cb61-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Metros cuadrados"</span>, <span class="at">y =</span> <span class="st">"Densidad"</span>, <span class="at">fill =</span> <span class="st">"Barrio"</span>) <span class="sc">+</span></span>
<span id="cb61-6"><a href="http://localhost:6551/#cb61-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_dark</span>() </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Removed 1644 rows containing non-finite values (`stat_density()`).</code></pre>
</div>
<div class="cell-output-display">
<p><img src="./AlejandroSáez-PracticaFinal_files/unnamed-chunk-27-1.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb63"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb63-1"><a href="http://localhost:6551/#cb63-1" aria-hidden="true" tabindex="-1"></a><span class="co"># En esta ocasión decidimos usar el parámetro scales con valor free, para que cada diagrama utilice su propia escala, ya que en caso de usar fixed, los datos mostrados no </span></span>
<span id="cb63-2"><a href="http://localhost:6551/#cb63-2" aria-hidden="true" tabindex="-1"></a><span class="co"># permitían una observación detallada. De este modo podemos ver como por ejemplo en el barrio de Recoletos los apartamentos son muy pequeños en relación con otros barrios</span></span>
<span id="cb63-3"><a href="http://localhost:6551/#cb63-3" aria-hidden="true" tabindex="-1"></a><span class="co"># donde existen apartamentos con mayores espacios, como Sol. O ver distribuciones más homogeneas como en el caso de Goya o incluso Justicia</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Esta claro que las medias de metros cuadrados de cada uno de estos 5 barrios parecen ser diferentes, pero ¿son estadísticamente diferentes? ¿Que test habría que usar para comprobarlo?</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb64"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb64-1"><a href="http://localhost:6551/#cb64-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Primero comprobaremos con un test de Saphiro si los cinco grupos siguen una distribución gaussiana:</span></span>
<span id="cb64-2"><a href="http://localhost:6551/#cb64-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-3"><a href="http://localhost:6551/#cb64-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Para comprobar si la diferencia en las medias de los precios de estos barrios es estadísticamente significativa, en primer lugar aplicaremos el test de Saphiro para saber si los valores de cada grupo siguen una distribución gaussiana</span></span>
<span id="cb64-4"><a href="http://localhost:6551/#cb64-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-5"><a href="http://localhost:6551/#cb64-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-6"><a href="http://localhost:6551/#cb64-6" aria-hidden="true" tabindex="-1"></a>metrosCuadrados_Goya <span class="ot">&lt;-</span> airbnb_entire_top5<span class="sc">$</span>MetrosCuadrados[airbnb_entire_top5<span class="sc">$</span>Barrio <span class="sc">==</span> <span class="st">"Goya"</span>]</span>
<span id="cb64-7"><a href="http://localhost:6551/#cb64-7" aria-hidden="true" tabindex="-1"></a>metrosCuadrados_Justicia <span class="ot">&lt;-</span> airbnb_entire_top5<span class="sc">$</span>MetrosCuadrados[airbnb_entire_top5<span class="sc">$</span>Barrio <span class="sc">==</span> <span class="st">"Justicia"</span>]</span>
<span id="cb64-8"><a href="http://localhost:6551/#cb64-8" aria-hidden="true" tabindex="-1"></a>metrosCuadrados_Recoletos <span class="ot">&lt;-</span> airbnb_entire_top5<span class="sc">$</span>MetrosCuadrados[airbnb_entire_top5<span class="sc">$</span>Barrio <span class="sc">==</span> <span class="st">"Recoletos"</span>]</span>
<span id="cb64-9"><a href="http://localhost:6551/#cb64-9" aria-hidden="true" tabindex="-1"></a>metrosCuadrados_Sol <span class="ot">&lt;-</span> airbnb_entire_top5<span class="sc">$</span>MetrosCuadrados[airbnb_entire_top5<span class="sc">$</span>Barrio <span class="sc">==</span> <span class="st">"Sol"</span>]</span>
<span id="cb64-10"><a href="http://localhost:6551/#cb64-10" aria-hidden="true" tabindex="-1"></a>metrosCuadrados_Trafalgar <span class="ot">&lt;-</span> airbnb_entire_top5<span class="sc">$</span>MetrosCuadrados[airbnb_entire_top5<span class="sc">$</span>Barrio <span class="sc">==</span> <span class="st">"Trafalgar"</span>]</span>
<span id="cb64-11"><a href="http://localhost:6551/#cb64-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-12"><a href="http://localhost:6551/#cb64-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-13"><a href="http://localhost:6551/#cb64-13" aria-hidden="true" tabindex="-1"></a><span class="fu">shapiro.test</span>(metrosCuadrados_Goya)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Shapiro-Wilk normality test

data:  metrosCuadrados_Goya
W = 0.93813, p-value = 0.5199</code></pre>
</div>
<div class="sourceCode cell-code" id="cb66"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb66-1"><a href="http://localhost:6551/#cb66-1" aria-hidden="true" tabindex="-1"></a><span class="fu">shapiro.test</span>(metrosCuadrados_Justicia)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Shapiro-Wilk normality test

data:  metrosCuadrados_Justicia
W = 0.76212, p-value = 0.0006419</code></pre>
</div>
<div class="sourceCode cell-code" id="cb68"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb68-1"><a href="http://localhost:6551/#cb68-1" aria-hidden="true" tabindex="-1"></a><span class="fu">shapiro.test</span>(metrosCuadrados_Recoletos)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Shapiro-Wilk normality test

data:  metrosCuadrados_Recoletos
W = 0.75, p-value &lt; 2.2e-16</code></pre>
</div>
<div class="sourceCode cell-code" id="cb70"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb70-1"><a href="http://localhost:6551/#cb70-1" aria-hidden="true" tabindex="-1"></a><span class="fu">shapiro.test</span>(metrosCuadrados_Sol)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Shapiro-Wilk normality test

data:  metrosCuadrados_Sol
W = 0.83089, p-value = 8.691e-07</code></pre>
</div>
<div class="sourceCode cell-code" id="cb72"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb72-1"><a href="http://localhost:6551/#cb72-1" aria-hidden="true" tabindex="-1"></a><span class="fu">shapiro.test</span>(metrosCuadrados_Trafalgar)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Shapiro-Wilk normality test

data:  metrosCuadrados_Trafalgar
W = 0.75023, p-value = 0.01276</code></pre>
</div>
<div class="sourceCode cell-code" id="cb74"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb74-1"><a href="http://localhost:6551/#cb74-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Excepto en el caso de Goya, en todos los demás el p-valor es muy pequeño, lo que significa que podemos descartar la hipótesis nula y afirmar que NO se trata de una distribución normal en todos los casos.</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb75"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb75-1"><a href="http://localhost:6551/#cb75-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Aplicaremos el test de Kruskal para comprobar si hay diferencia estadística significativa. La hipótesis nula será que no hay diferencias significativas, mientras que la hipótesis alternativa será que sí las hay</span></span>
<span id="cb75-2"><a href="http://localhost:6551/#cb75-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb75-3"><a href="http://localhost:6551/#cb75-3" aria-hidden="true" tabindex="-1"></a><span class="fu">kruskal.test</span>(MetrosCuadrados <span class="sc">~</span> Barrio, airbnb_entire_top5)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Kruskal-Wallis rank sum test

data:  MetrosCuadrados by Barrio
Kruskal-Wallis chi-squared = 1.882, df = 4, p-value = 0.7574</code></pre>
</div>
<div class="sourceCode cell-code" id="cb77"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb77-1"><a href="http://localhost:6551/#cb77-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Según el test de Kruskal-Wallis, NO hay diferencia estadística significativa entre los diferentes barrios ya que p-value = 0.7574</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Para únicamente los pisos de alquiler en el barrio de Sol:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb78"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb78-1"><a href="http://localhost:6551/#cb78-1" aria-hidden="true" tabindex="-1"></a>barrio_sol<span class="ot">&lt;-</span><span class="fu">subset</span>(airbnb_entire,Barrio<span class="sc">==</span><span class="st">"Sol"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Calcular un modelo lineal que combine alguna de estas variables: * NumBanyos * NumDormitorios * MaxOcupantes * MetrosCuadrados</p>
<p>Primero calculamos la correlación para ver como se relacionan estas variables entre sí.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb79"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb79-1"><a href="http://localhost:6551/#cb79-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Para calcular la matriz de correlación, en primer lugar comprobaremos si las variables siguen o no una distribución normal. De ello dependerá el método (Pearson o Spearman) que utilizaremos</span></span>
<span id="cb79-2"><a href="http://localhost:6551/#cb79-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-3"><a href="http://localhost:6551/#cb79-3" aria-hidden="true" tabindex="-1"></a><span class="fu">shapiro.test</span>(barrio_sol<span class="sc">$</span>NumBanyos)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Shapiro-Wilk normality test

data:  barrio_sol$NumBanyos
W = 0.54147, p-value &lt; 2.2e-16</code></pre>
</div>
<div class="sourceCode cell-code" id="cb81"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb81-1"><a href="http://localhost:6551/#cb81-1" aria-hidden="true" tabindex="-1"></a><span class="fu">shapiro.test</span>(barrio_sol<span class="sc">$</span>NumDormitorios)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Shapiro-Wilk normality test

data:  barrio_sol$NumDormitorios
W = 0.82593, p-value &lt; 2.2e-16</code></pre>
</div>
<div class="sourceCode cell-code" id="cb83"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb83-1"><a href="http://localhost:6551/#cb83-1" aria-hidden="true" tabindex="-1"></a><span class="fu">shapiro.test</span>(barrio_sol<span class="sc">$</span>MaxOcupantes)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Shapiro-Wilk normality test

data:  barrio_sol$MaxOcupantes
W = 0.83282, p-value &lt; 2.2e-16</code></pre>
</div>
<div class="sourceCode cell-code" id="cb85"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb85-1"><a href="http://localhost:6551/#cb85-1" aria-hidden="true" tabindex="-1"></a><span class="fu">shapiro.test</span>(barrio_sol<span class="sc">$</span>MetrosCuadrados)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Shapiro-Wilk normality test

data:  barrio_sol$MetrosCuadrados
W = 0.83089, p-value = 8.691e-07</code></pre>
</div>
<div class="sourceCode cell-code" id="cb87"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb87-1"><a href="http://localhost:6551/#cb87-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Según Saphiro, los datos no siguen una distribución gaussiana, por lo que aplicaremos la función de correlación con el método de Spearman</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb88"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb88-1"><a href="http://localhost:6551/#cb88-1" aria-hidden="true" tabindex="-1"></a>barrio_sol_model <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(barrio_sol<span class="sc">$</span>NumBanyos, barrio_sol<span class="sc">$</span>NumDormitorios, barrio_sol<span class="sc">$</span>MaxOcupantes, barrio_sol<span class="sc">$</span>MetrosCuadrados)</span>
<span id="cb88-2"><a href="http://localhost:6551/#cb88-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb88-3"><a href="http://localhost:6551/#cb88-3" aria-hidden="true" tabindex="-1"></a><span class="fu">cor</span>(barrio_sol_model, <span class="at">method =</span> <span class="st">"spearman"</span>,<span class="at">use=</span><span class="st">"pairwise.complete.obs"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>                           barrio_sol.NumBanyos barrio_sol.NumDormitorios
barrio_sol.NumBanyos                  1.0000000                 0.6340408
barrio_sol.NumDormitorios             0.6340408                 1.0000000
barrio_sol.MaxOcupantes               0.6007382                 0.7519491
barrio_sol.MetrosCuadrados            0.3441343                 0.3519002
                           barrio_sol.MaxOcupantes barrio_sol.MetrosCuadrados
barrio_sol.NumBanyos                     0.6007382                  0.3441343
barrio_sol.NumDormitorios                0.7519491                  0.3519002
barrio_sol.MaxOcupantes                  1.0000000                  0.3538099
barrio_sol.MetrosCuadrados               0.3538099                  1.0000000</code></pre>
</div>
</div>
<p>Se observa que la correlación entre el número de dormitorios y los metros cuadrados es sorprendentemente baja. ¿Son de fiar esos números?</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb90"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb90-1"><a href="http://localhost:6551/#cb90-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Se debe tener en cuenta que la correlación no implica causalidad y que habría que ver otros análisis para sacar conclusiones a esa correlación más baja. tal vez podría tener sentido en tanto a que pisos más caros tienen espacios más grandes, y no por ello más habitaciones, o, por el contrario, que las personas que ponen casas en alquiler en airbnb intentan tener el mayor número de habitaciones posible aunque sean pequeñas, por lo que al aumentar el número de habitaciones, no necesariamente aumentaría tanto el de metros cuadrados, pero haría falta otro tipo de análisis para esclarecer esto.</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Mediante un histograma o curvas de densidad podemos descartar números que notienen sentido en el dataframe barrio_sol, para tener una matriz de correlación que tenga mayor sentido.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb91"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb91-1"><a href="http://localhost:6551/#cb91-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> barrio_sol, <span class="fu">aes</span>(<span class="at">x =</span> NumBanyos)) <span class="sc">+</span></span>
<span id="cb91-2"><a href="http://localhost:6551/#cb91-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_density</span>(<span class="at">color =</span> <span class="st">"blue"</span>) <span class="sc">+</span></span>
<span id="cb91-3"><a href="http://localhost:6551/#cb91-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Num Baños"</span>, <span class="at">y =</span> <span class="st">"Densidad"</span>, <span class="at">title =</span> <span class="st">"Número baños"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="./AlejandroSáez-PracticaFinal_files/unnamed-chunk-34-1.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb92"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb92-1"><a href="http://localhost:6551/#cb92-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> barrio_sol, <span class="fu">aes</span>(<span class="at">x =</span> NumDormitorios)) <span class="sc">+</span></span>
<span id="cb92-2"><a href="http://localhost:6551/#cb92-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_density</span>(<span class="at">color =</span> <span class="st">"red"</span>) <span class="sc">+</span></span>
<span id="cb92-3"><a href="http://localhost:6551/#cb92-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Num Dormitorios"</span>, <span class="at">y =</span> <span class="st">"Densidad"</span>, <span class="at">title =</span> <span class="st">"Número dormitorios"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="./AlejandroSáez-PracticaFinal_files/unnamed-chunk-34-2.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb93"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb93-1"><a href="http://localhost:6551/#cb93-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> barrio_sol, <span class="fu">aes</span>(<span class="at">x =</span> MaxOcupantes)) <span class="sc">+</span></span>
<span id="cb93-2"><a href="http://localhost:6551/#cb93-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_density</span>(<span class="at">color =</span> <span class="st">"yellow"</span>) <span class="sc">+</span></span>
<span id="cb93-3"><a href="http://localhost:6551/#cb93-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Max Ocupantes"</span>, <span class="at">y =</span> <span class="st">"Densidad"</span>, <span class="at">title =</span> <span class="st">"Número ocupantes máximo"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="./AlejandroSáez-PracticaFinal_files/unnamed-chunk-34-3.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb94"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb94-1"><a href="http://localhost:6551/#cb94-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> barrio_sol, <span class="fu">aes</span>(<span class="at">x =</span> MetrosCuadrados)) <span class="sc">+</span></span>
<span id="cb94-2"><a href="http://localhost:6551/#cb94-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_density</span>(<span class="at">color =</span> <span class="st">"green"</span>) <span class="sc">+</span></span>
<span id="cb94-3"><a href="http://localhost:6551/#cb94-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Metros cuadrados"</span>, <span class="at">y =</span> <span class="st">"Densidad"</span>, <span class="at">title =</span> <span class="st">"Metros cuadrados"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Removed 641 rows containing non-finite values (`stat_density()`).</code></pre>
</div>
<div class="cell-output-display">
<p><img src="./AlejandroSáez-PracticaFinal_files/unnamed-chunk-34-4.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb96"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb96-1"><a href="http://localhost:6551/#cb96-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> barrio_sol, <span class="fu">aes</span>(<span class="at">x =</span> NumBanyos)) <span class="sc">+</span></span>
<span id="cb96-2"><a href="http://localhost:6551/#cb96-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="at">fill =</span> <span class="st">"blue"</span>) <span class="sc">+</span></span>
<span id="cb96-3"><a href="http://localhost:6551/#cb96-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Num Baños"</span>, <span class="at">y =</span> <span class="st">"Densidad"</span>, <span class="at">title =</span> <span class="st">"Número baños"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>`stat_bin()` using `bins = 30`. Pick better value with `binwidth`.</code></pre>
</div>
<div class="cell-output-display">
<p><img src="./AlejandroSáez-PracticaFinal_files/unnamed-chunk-34-5.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb98"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb98-1"><a href="http://localhost:6551/#cb98-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> barrio_sol, <span class="fu">aes</span>(<span class="at">x =</span> NumDormitorios)) <span class="sc">+</span></span>
<span id="cb98-2"><a href="http://localhost:6551/#cb98-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="at">fill =</span> <span class="st">"red"</span>) <span class="sc">+</span></span>
<span id="cb98-3"><a href="http://localhost:6551/#cb98-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Num Dormitorios"</span>, <span class="at">y =</span> <span class="st">"Densidad"</span>, <span class="at">title =</span> <span class="st">"Número dormitorios"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>`stat_bin()` using `bins = 30`. Pick better value with `binwidth`.</code></pre>
</div>
<div class="cell-output-display">
<p><img src="./AlejandroSáez-PracticaFinal_files/unnamed-chunk-34-6.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb100"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb100-1"><a href="http://localhost:6551/#cb100-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> barrio_sol, <span class="fu">aes</span>(<span class="at">x =</span> MaxOcupantes)) <span class="sc">+</span></span>
<span id="cb100-2"><a href="http://localhost:6551/#cb100-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="at">fill =</span> <span class="st">"yellow"</span>) <span class="sc">+</span></span>
<span id="cb100-3"><a href="http://localhost:6551/#cb100-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Max Ocupantes"</span>, <span class="at">y =</span> <span class="st">"Densidad"</span>, <span class="at">title =</span> <span class="st">"Número ocupantes máximo"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>`stat_bin()` using `bins = 30`. Pick better value with `binwidth`.</code></pre>
</div>
<div class="cell-output-display">
<p><img src="./AlejandroSáez-PracticaFinal_files/unnamed-chunk-34-7.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb102"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb102-1"><a href="http://localhost:6551/#cb102-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> barrio_sol, <span class="fu">aes</span>(<span class="at">x =</span> MetrosCuadrados)) <span class="sc">+</span></span>
<span id="cb102-2"><a href="http://localhost:6551/#cb102-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="at">fill =</span> <span class="st">"green"</span>) <span class="sc">+</span></span>
<span id="cb102-3"><a href="http://localhost:6551/#cb102-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Metros cuadrados"</span>, <span class="at">y =</span> <span class="st">"Densidad"</span>, <span class="at">title =</span> <span class="st">"Metros cuadrados"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>`stat_bin()` using `bins = 30`. Pick better value with `binwidth`.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Removed 641 rows containing non-finite values (`stat_bin()`).</code></pre>
</div>
<div class="cell-output-display">
<p><img src="./AlejandroSáez-PracticaFinal_files/unnamed-chunk-34-8.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb105"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb105-1"><a href="http://localhost:6551/#cb105-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Dadas las curvas de densidad e histogramas, podríamos descartar algunos valores extremos, como todos aquellos con más de 4 baños, más de 5 dormitorios o más de 12 ocupantes.</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Una vez que hayamos filtrado los datos correspondientes calcular el valor o la combinación de valores que mejor nos permite obtener el precio de un inmueble.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb106"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb106-1"><a href="http://localhost:6551/#cb106-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Haremos el filtro según lo estimado en el anterior punto:</span></span>
<span id="cb106-2"><a href="http://localhost:6551/#cb106-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb106-3"><a href="http://localhost:6551/#cb106-3" aria-hidden="true" tabindex="-1"></a>barrio_sol_filtrado <span class="ot">&lt;-</span> barrio_sol[barrio_sol<span class="sc">$</span>NumBanyos <span class="sc">&lt;=</span> <span class="dv">4</span> <span class="sc">&amp;</span> barrio_sol<span class="sc">$</span>NumDormitorios <span class="sc">&lt;=</span> <span class="dv">5</span> <span class="sc">&amp;</span> barrio_sol<span class="sc">$</span>MaxOcupantes <span class="sc">&lt;=</span> <span class="dv">12</span>, ]</span>
<span id="cb106-4"><a href="http://localhost:6551/#cb106-4" aria-hidden="true" tabindex="-1"></a><span class="co">#barrio_sol_filtrado</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb107"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb107-1"><a href="http://localhost:6551/#cb107-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(GGally)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Registered S3 method overwritten by 'GGally':
  method from   
  +.gg   ggplot2</code></pre>
</div>
<div class="sourceCode cell-code" id="cb109"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb109-1"><a href="http://localhost:6551/#cb109-1" aria-hidden="true" tabindex="-1"></a><span class="fu">options</span>(<span class="at">repr.plot.height=</span><span class="dv">4</span>,<span class="at">repr.plot.width=</span><span class="dv">6</span>)</span>
<span id="cb109-2"><a href="http://localhost:6551/#cb109-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggpairs</span>(barrio_sol_filtrado[,<span class="fu">c</span>(<span class="st">"NumBanyos"</span>,<span class="st">"NumDormitorios"</span>,<span class="st">"MaxOcupantes"</span>,<span class="st">"MetrosCuadrados"</span>, <span class="st">"NumCamas"</span>, <span class="st">"Puntuacion"</span>, <span class="st">"Precio"</span>)],</span>
<span id="cb109-3"><a href="http://localhost:6551/#cb109-3" aria-hidden="true" tabindex="-1"></a>       <span class="co">#lower = list(continuous = wrap("density", alpha = 0.8,size=0.2,color='blue'))</span></span>
<span id="cb109-4"><a href="http://localhost:6551/#cb109-4" aria-hidden="true" tabindex="-1"></a>       <span class="at">lower =</span> <span class="fu">list</span>(<span class="at">continuous =</span> <span class="fu">wrap</span>(<span class="st">"points"</span>, <span class="at">alpha =</span> <span class="fl">0.3</span>,<span class="at">size=</span><span class="fl">0.1</span>,<span class="at">color=</span><span class="st">'blue'</span>))</span>
<span id="cb109-5"><a href="http://localhost:6551/#cb109-5" aria-hidden="true" tabindex="-1"></a>       )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in ggally_statistic(data = data, mapping = mapping, na.rm = na.rm, :
Removed 637 rows containing missing values</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in ggally_statistic(data = data, mapping = mapping, na.rm = na.rm, :
Removed 69 rows containing missing values</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in ggally_statistic(data = data, mapping = mapping, na.rm = na.rm, :
Removed 637 rows containing missing values</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in ggally_statistic(data = data, mapping = mapping, na.rm = na.rm, :
Removed 69 rows containing missing values</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in ggally_statistic(data = data, mapping = mapping, na.rm = na.rm, :
Removed 637 rows containing missing values</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in ggally_statistic(data = data, mapping = mapping, na.rm = na.rm, :
Removed 69 rows containing missing values</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Removed 637 rows containing missing values (`geom_point()`).
Removed 637 rows containing missing values (`geom_point()`).
Removed 637 rows containing missing values (`geom_point()`).</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Removed 637 rows containing non-finite values (`stat_density()`).</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in ggally_statistic(data = data, mapping = mapping, na.rm = na.rm, :
Removed 637 rows containing missing values

Warning in ggally_statistic(data = data, mapping = mapping, na.rm = na.rm, :
Removed 637 rows containing missing values

Warning in ggally_statistic(data = data, mapping = mapping, na.rm = na.rm, :
Removed 637 rows containing missing values</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Removed 637 rows containing missing values (`geom_point()`).</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in ggally_statistic(data = data, mapping = mapping, na.rm = na.rm, :
Removed 69 rows containing missing values</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Removed 69 rows containing missing values (`geom_point()`).
Removed 69 rows containing missing values (`geom_point()`).
Removed 69 rows containing missing values (`geom_point()`).</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Removed 637 rows containing missing values (`geom_point()`).</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Removed 69 rows containing missing values (`geom_point()`).</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Removed 69 rows containing non-finite values (`stat_density()`).</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in ggally_statistic(data = data, mapping = mapping, na.rm = na.rm, :
Removed 69 rows containing missing values</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Removed 637 rows containing missing values (`geom_point()`).</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Removed 69 rows containing missing values (`geom_point()`).</code></pre>
</div>
<div class="cell-output-display">
<p><img src="./AlejandroSáez-PracticaFinal_files/unnamed-chunk-36-1.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb128"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb128-1"><a href="http://localhost:6551/#cb128-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Hemos incluido para obtener esta matriz de correlación algún otro valor como Número de camas y Puntuación. La mayor correlación con el precio se produce no obstante entre las cuatro variables que estabamos estudiando arriba (Número de baños, Número de dormitorios, Máximo de ocupantes y Metros cuadrados. También vemos que la puntuación tiene baja correlación, lo cual puede ser sorprendente)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb129"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb129-1"><a href="http://localhost:6551/#cb129-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Nos quedaremos con las cuatro variables con mayor correlación</span></span>
<span id="cb129-2"><a href="http://localhost:6551/#cb129-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-3"><a href="http://localhost:6551/#cb129-3" aria-hidden="true" tabindex="-1"></a>model<span class="ot">&lt;-</span><span class="fu">lm</span>(<span class="at">data=</span>barrio_sol_filtrado, <span class="at">formula =</span> Precio <span class="sc">~</span> NumBanyos<span class="sc">+</span>NumDormitorios<span class="sc">+</span>MaxOcupantes<span class="sc">+</span>MetrosCuadrados)</span>
<span id="cb129-4"><a href="http://localhost:6551/#cb129-4" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(model)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = Precio ~ NumBanyos + NumDormitorios + MaxOcupantes + 
    MetrosCuadrados, data = barrio_sol_filtrado)

Residuals:
    Min      1Q  Median      3Q     Max 
-69.773 -14.530  -3.525   9.779 105.464 

Coefficients:
                Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)     38.04915   10.41213   3.654 0.000584 ***
NumBanyos       11.14731   10.36721   1.075 0.287045    
NumDormitorios  22.58510    6.45622   3.498 0.000946 ***
MaxOcupantes     0.08493    3.11096   0.027 0.978320    
MetrosCuadrados  0.23892    0.10482   2.279 0.026624 *  
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 31.91 on 54 degrees of freedom
  (637 observations deleted due to missingness)
Multiple R-squared:  0.629, Adjusted R-squared:  0.6015 
F-statistic: 22.89 on 4 and 54 DF,  p-value: 4.242e-11</code></pre>
</div>
</div>
<p>¿Que variable es más fiable para conocer el precio de un inmueble, el número de habitaciones o los metros cuadrados?</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb131"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb131-1"><a href="http://localhost:6551/#cb131-1" aria-hidden="true" tabindex="-1"></a><span class="co"># El NÚMERO DE HABITACIONES parece ser el más influyente según su p-valor en el modelo y por tanto el más fiable, los metros cuadrados parecen tener una relación mucho menor (NumDormitorios tiene 3 estrellas, MetrosCuadrados una)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Responde con su correspondiente margen de error del 95%, ¿cuantos euros incrementa el precio del alquiler por cada metro cuadrado extra del piso?</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb132"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb132-1"><a href="http://localhost:6551/#cb132-1" aria-hidden="true" tabindex="-1"></a><span class="fu">confint</span>(<span class="fu">lm</span>(Precio <span class="sc">~</span> MetrosCuadrados, barrio_sol_filtrado), <span class="at">level =</span> <span class="fl">0.95</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>                     2.5 %     97.5 %
(Intercept)     55.5127981 82.9961941
MetrosCuadrados  0.4191837  0.8142655</code></pre>
</div>
<div class="sourceCode cell-code" id="cb134"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb134-1"><a href="http://localhost:6551/#cb134-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Con un intervalo de confianza del 95% podemos decir que por cada metro cuadrado extra, el valor del alquiler se incrementa entre 0.4191837 y 0.8142655 euros</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Responde con su correspondiente margen de error del 95%, ¿cuantos euros incrementa el precio del alquiler por cada habitación?</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb135"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb135-1"><a href="http://localhost:6551/#cb135-1" aria-hidden="true" tabindex="-1"></a><span class="fu">confint</span>(<span class="fu">lm</span>(Precio <span class="sc">~</span> NumDormitorios, barrio_sol_filtrado), <span class="at">level =</span> <span class="fl">0.95</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>                  2.5 %  97.5 %
(Intercept)    48.58829 58.0721
NumDormitorios 29.63486 35.2648</code></pre>
</div>
<div class="sourceCode cell-code" id="cb137"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb137-1"><a href="http://localhost:6551/#cb137-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Con un intervalo de confianza del 95% podemos decir que por cada habitación extra, el precio del alquiler se incrementa entre 29.63486 y 35.2648 euros, lo que confirma que el número de habitaciones es mucho más iportante en el precio que el de metros cuadrados</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>¿Cual es la probabilidad de encontrar, en el barrio de Sol, un apartamento en alquiler con 3 dormitorios? ¿Cual es el intervalo de confianza de esa probabilidad? (ver el numero de exitos (apartamentos en alquiler con tres dormitorios), respecto del total de apartamentos)</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb138"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb138-1"><a href="http://localhost:6551/#cb138-1" aria-hidden="true" tabindex="-1"></a><span class="co">#sum(barrio_sol[which(barrio_sol$NumDormitorios == 3)])</span></span>
<span id="cb138-2"><a href="http://localhost:6551/#cb138-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb138-3"><a href="http://localhost:6551/#cb138-3" aria-hidden="true" tabindex="-1"></a>num_3Dormitorios <span class="ot">&lt;-</span> <span class="fu">sum</span>(barrio_sol<span class="sc">$</span>NumDormitorios <span class="sc">==</span> <span class="dv">3</span>)</span>
<span id="cb138-4"><a href="http://localhost:6551/#cb138-4" aria-hidden="true" tabindex="-1"></a>total_Disponibles <span class="ot">&lt;-</span> <span class="fu">sum</span>(barrio_sol<span class="sc">$</span>NumDormitorios)</span>
<span id="cb138-5"><a href="http://localhost:6551/#cb138-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb138-6"><a href="http://localhost:6551/#cb138-6" aria-hidden="true" tabindex="-1"></a>prob_3 <span class="ot">&lt;-</span> num_3Dormitorios<span class="sc">/</span>total_Disponibles</span>
<span id="cb138-7"><a href="http://localhost:6551/#cb138-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb138-8"><a href="http://localhost:6551/#cb138-8" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">paste</span>(<span class="st">"La probabilidad de encontrar en Sol un apartamento con tres dormitorios es: "</span>, prob_3))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "La probabilidad de encontrar en Sol un apartamento con tres dormitorios es:  0.0543478260869565"</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb140"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb140-1"><a href="http://localhost:6551/#cb140-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Para calcular el intervalo de confianza de esta probabilidad, utilizaremos un test BINOMIAL (binom.test)</span></span>
<span id="cb140-2"><a href="http://localhost:6551/#cb140-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb140-3"><a href="http://localhost:6551/#cb140-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(binom)</span>
<span id="cb140-4"><a href="http://localhost:6551/#cb140-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb140-5"><a href="http://localhost:6551/#cb140-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb140-6"><a href="http://localhost:6551/#cb140-6" aria-hidden="true" tabindex="-1"></a>r1 <span class="ot">&lt;-</span> <span class="fu">round</span>(<span class="fu">binom.test</span>(num_3Dormitorios, total_Disponibles)<span class="sc">$</span>conf.int, <span class="dv">4</span>)</span>
<span id="cb140-7"><a href="http://localhost:6551/#cb140-7" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">paste0</span>(<span class="st">"La probabilidad de encontrar en Sol un apartamento con tres dormitorios es: "</span>, prob_3,</span>
<span id="cb140-8"><a href="http://localhost:6551/#cb140-8" aria-hidden="true" tabindex="-1"></a>             <span class="st">" con un intervalo de confianza de: ["</span>, r1[<span class="dv">1</span>], <span class="st">","</span>, r1[<span class="dv">2</span>], <span class="st">"]"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "La probabilidad de encontrar en Sol un apartamento con tres dormitorios es: 0.0543478260869565 con un intervalo de confianza de: [0.0412,0.0702]"</code></pre>
</div>
</div>

</main>
<!-- /main column -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    target: function(trigger) {
      return trigger.previousElementSibling;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->




<div class="modal__dialog micromodal-slide" id="quarto-log-error-modal" aria-hidden="true">
  <div class="modal__overlay" tabindex="2" data-micromodal-close="">
    <div class="modal__container" role="dialog" aria-modal="true" aria-labelledby="quarto-log-error-modal-title">
      <header class="modal__header">
        <h2 class="modal__title" id="quarto-log-error-modal-title">
          <i class="bi bi-exclamation-circle"></i>Error
        </h2>
        <button class="modal__close" aria-label="Close modal" data-micromodal-close=""></button>
      </header>
      <div class="modal__content" id="quarto-log-error-modal-content">
        <pre tabindex="1" id="quarto-log-error-display"></pre>
      </div>
      <footer class="modal__footer">
      </footer>
    </div>
  </div>
</div>
<style type="text/css">
#quarto-log-error-modal .modal__overlay {
  z-index: 5000;
}
#quarto-log-error-modal-content {
  border: 1px solid #dee2e6;
  overflow-y: auto;
}
#quarto-log-error-display {
  min-height: 100px;
  padding: 8px;
  margin-bottom: 0;
  font-family: monospace;
}
#quarto-log-error-display:focus {
  outline: none;
}
.modal__dialog {
  font-size: 16px;
}
.modal__overlay {
  position: fixed;
  top: 0;
  left: 0;
  right: 0;
  bottom: 0;
  background: rgba(0,0,0,0.4);
  display: flex;
  justify-content: center;
  align-items: center;
}
.modal__container {
  position: fixed;
  top: 80px;
  background-color: #fff;
  padding: 15px;
  padding-top: 10px;
  min-width: 500px;
  max-width: 90%;
  max-height: 90vh;
  border-radius: 4px;
  overflow-y: auto;
  box-sizing: border-box;
}
.modal__header {
  display: flex;
  justify-content: space-between;
  align-items: center;
}
.modal__title {
  margin-top: 0;
  margin-bottom: 0;
  font-weight: 600;
  border-bottom: none;
  padding-bottom: 10px;
  font-size: 20px;
  color: rgb(191,71,65);
  line-height: 1.25;
  box-sizing: border-box;
}
.modal__title .bi {
  margin-right: 7px;
}
.modal__close {
  background: transparent;
  border: 0;
  margin-bottom: 10px;
}
.modal__header .modal__close:before { content: "\2715"; }
.modal__content {
  margin-top: 0;
  margin-bottom: 0;
}
@keyframes mmfadeIn {
    from { opacity: 0; }
      to { opacity: 1; }
}
@keyframes mmfadeOut {
    from { opacity: 1; }
      to { opacity: 0; }
}
@keyframes mmslideIn {
  from { transform: translateY(15%); }
    to { transform: translateY(0); }
}
@keyframes mmslideOut {
    from { transform: translateY(0); }
    to { transform: translateY(-10%); }
}
.micromodal-slide {
  display: none;
}
.micromodal-slide.is-open {
  display: block;
}
.micromodal-slide[aria-hidden="false"] .modal__overlay {
  animation: mmfadeIn .3s cubic-bezier(0.0, 0.0, 0.2, 1);
}
.micromodal-slide[aria-hidden="false"] .modal__container {
  animation: mmslideIn .3s cubic-bezier(0, 0, .2, 1);
}
.micromodal-slide[aria-hidden="true"] .modal__overlay {
  animation: mmfadeOut .3s cubic-bezier(0.0, 0.0, 0.2, 1);
}
.micromodal-slide[aria-hidden="true"] .modal__container {
  animation: mmslideOut .3s cubic-bezier(0, 0, .2, 1);
}
.micromodal-slide .modal__container,
.micromodal-slide .modal__overlay {
  will-change: transform;
} 
</style>
<script type="text/javascript">
  window.backupDefine = window.define; window.define = undefined;
  /*  ansi_up.js
   *  author : Dru Nelson
   *  license : MIT
   *  http://github.com/drudru/ansi_up
   */
   (function (root, factory) {
      if (typeof define === 'function' && define.amd) {
          // AMD. Register as an anonymous module.
          define(['exports'], factory);
      } else if (typeof exports === 'object' && typeof exports.nodeName !== 'string') {
          // CommonJS
          factory(exports);
      } else {
          // Browser globals
          var exp = {};
          factory(exp);
          root.AnsiUp = exp.default;
      }
  }(this, function (exports) {
  "use strict";
  var __makeTemplateObject = (this && this.__makeTemplateObject) || function (cooked, raw) {
      if (Object.defineProperty) { Object.defineProperty(cooked, "raw", { value: raw }); } else { cooked.raw = raw; }
      return cooked;
  };
  var PacketKind;
  (function (PacketKind) {
      PacketKind[PacketKind["EOS"] = 0] = "EOS";
      PacketKind[PacketKind["Text"] = 1] = "Text";
      PacketKind[PacketKind["Incomplete"] = 2] = "Incomplete";
      PacketKind[PacketKind["ESC"] = 3] = "ESC";
      PacketKind[PacketKind["Unknown"] = 4] = "Unknown";
      PacketKind[PacketKind["SGR"] = 5] = "SGR";
      PacketKind[PacketKind["OSCURL"] = 6] = "OSCURL";
  })(PacketKind || (PacketKind = {}));
  var AnsiUp = (function () {
      function AnsiUp() {
          this.VERSION = "5.1.0";
          this.setup_palettes();
          this._use_classes = false;
          this.bold = false;
          this.italic = false;
          this.underline = false;
          this.fg = this.bg = null;
          this._buffer = '';
          this._url_whitelist = { 'http': 1, 'https': 1 };
      }
      Object.defineProperty(AnsiUp.prototype, "use_classes", {
          get: function () {
              return this._use_classes;
          },
          set: function (arg) {
              this._use_classes = arg;
          },
          enumerable: false,
          configurable: true
      });
      Object.defineProperty(AnsiUp.prototype, "url_whitelist", {
          get: function () {
              return this._url_whitelist;
          },
          set: function (arg) {
              this._url_whitelist = arg;
          },
          enumerable: false,
          configurable: true
      });
      AnsiUp.prototype.setup_palettes = function () {
          var _this = this;
          this.ansi_colors =
              [
                  [
                      { rgb: [0, 0, 0], class_name: "ansi-black" },
                      { rgb: [187, 0, 0], class_name: "ansi-red" },
                      { rgb: [0, 187, 0], class_name: "ansi-green" },
                      { rgb: [187, 187, 0], class_name: "ansi-yellow" },
                      { rgb: [0, 0, 187], class_name: "ansi-blue" },
                      { rgb: [187, 0, 187], class_name: "ansi-magenta" },
                      { rgb: [0, 187, 187], class_name: "ansi-cyan" },
                      { rgb: [255, 255, 255], class_name: "ansi-white" }
                  ],
                  [
                      { rgb: [85, 85, 85], class_name: "ansi-bright-black" },
                      { rgb: [255, 85, 85], class_name: "ansi-bright-red" },
                      { rgb: [0, 255, 0], class_name: "ansi-bright-green" },
                      { rgb: [255, 255, 85], class_name: "ansi-bright-yellow" },
                      { rgb: [85, 85, 255], class_name: "ansi-bright-blue" },
                      { rgb: [255, 85, 255], class_name: "ansi-bright-magenta" },
                      { rgb: [85, 255, 255], class_name: "ansi-bright-cyan" },
                      { rgb: [255, 255, 255], class_name: "ansi-bright-white" }
                  ]
              ];
          this.palette_256 = [];
          this.ansi_colors.forEach(function (palette) {
              palette.forEach(function (rec) {
                  _this.palette_256.push(rec);
              });
          });
          var levels = [0, 95, 135, 175, 215, 255];
          for (var r = 0; r < 6; ++r) {
              for (var g = 0; g < 6; ++g) {
                  for (var b = 0; b < 6; ++b) {
                      var col = { rgb: [levels[r], levels[g], levels[b]], class_name: 'truecolor' };
                      this.palette_256.push(col);
                  }
              }
          }
          var grey_level = 8;
          for (var i = 0; i < 24; ++i, grey_level += 10) {
              var gry = { rgb: [grey_level, grey_level, grey_level], class_name: 'truecolor' };
              this.palette_256.push(gry);
          }
      };
      AnsiUp.prototype.escape_txt_for_html = function (txt) {
          return txt.replace(/[&<>"']/gm, function (str) {
              if (str === "&")
                  return "&amp;";
              if (str === "<")
                  return "&lt;";
              if (str === ">")
                  return "&gt;";
              if (str === "\"")
                  return "&quot;";
              if (str === "'")
                  return "&#x27;";
          });
      };
      AnsiUp.prototype.append_buffer = function (txt) {
          var str = this._buffer + txt;
          this._buffer = str;
      };
      AnsiUp.prototype.get_next_packet = function () {
          var pkt = {
              kind: PacketKind.EOS,
              text: '',
              url: ''
          };
          var len = this._buffer.length;
          if (len == 0)
              return pkt;
          var pos = this._buffer.indexOf("\x1B");
          if (pos == -1) {
              pkt.kind = PacketKind.Text;
              pkt.text = this._buffer;
              this._buffer = '';
              return pkt;
          }
          if (pos > 0) {
              pkt.kind = PacketKind.Text;
              pkt.text = this._buffer.slice(0, pos);
              this._buffer = this._buffer.slice(pos);
              return pkt;
          }
          if (pos == 0) {
              if (len == 1) {
                  pkt.kind = PacketKind.Incomplete;
                  return pkt;
              }
              var next_char = this._buffer.charAt(1);
              if ((next_char != '[') && (next_char != ']')) {
                  pkt.kind = PacketKind.ESC;
                  pkt.text = this._buffer.slice(0, 1);
                  this._buffer = this._buffer.slice(1);
                  return pkt;
              }
              if (next_char == '[') {
                  if (!this._csi_regex) {
                      this._csi_regex = rgx(__makeTemplateObject(["\n                        ^                           # beginning of line\n                                                    #\n                                                    # First attempt\n                        (?:                         # legal sequence\n                          \u001B[                      # CSI\n                          ([<-?]?)              # private-mode char\n                          ([d;]*)                    # any digits or semicolons\n                          ([ -/]?               # an intermediate modifier\n                          [@-~])                # the command\n                        )\n                        |                           # alternate (second attempt)\n                        (?:                         # illegal sequence\n                          \u001B[                      # CSI\n                          [ -~]*                # anything legal\n                          ([\0-\u001F:])              # anything illegal\n                        )\n                    "], ["\n                        ^                           # beginning of line\n                                                    #\n                                                    # First attempt\n                        (?:                         # legal sequence\n                          \\x1b\\[                      # CSI\n                          ([\\x3c-\\x3f]?)              # private-mode char\n                          ([\\d;]*)                    # any digits or semicolons\n                          ([\\x20-\\x2f]?               # an intermediate modifier\n                          [\\x40-\\x7e])                # the command\n                        )\n                        |                           # alternate (second attempt)\n                        (?:                         # illegal sequence\n                          \\x1b\\[                      # CSI\n                          [\\x20-\\x7e]*                # anything legal\n                          ([\\x00-\\x1f:])              # anything illegal\n                        )\n                    "]));
                  }
                  var match = this._buffer.match(this._csi_regex);
                  if (match === null) {
                      pkt.kind = PacketKind.Incomplete;
                      return pkt;
                  }
                  if (match[4]) {
                      pkt.kind = PacketKind.ESC;
                      pkt.text = this._buffer.slice(0, 1);
                      this._buffer = this._buffer.slice(1);
                      return pkt;
                  }
                  if ((match[1] != '') || (match[3] != 'm'))
                      pkt.kind = PacketKind.Unknown;
                  else
                      pkt.kind = PacketKind.SGR;
                  pkt.text = match[2];
                  var rpos = match[0].length;
                  this._buffer = this._buffer.slice(rpos);
                  return pkt;
              }
              if (next_char == ']') {
                  if (len < 4) {
                      pkt.kind = PacketKind.Incomplete;
                      return pkt;
                  }
                  if ((this._buffer.charAt(2) != '8')
                      || (this._buffer.charAt(3) != ';')) {
                      pkt.kind = PacketKind.ESC;
                      pkt.text = this._buffer.slice(0, 1);
                      this._buffer = this._buffer.slice(1);
                      return pkt;
                  }
                  if (!this._osc_st) {
                      this._osc_st = rgxG(__makeTemplateObject(["\n                        (?:                         # legal sequence\n                          (\u001B\\)                    # ESC                           |                           # alternate\n                          (\u0007)                      # BEL (what xterm did)\n                        )\n                        |                           # alternate (second attempt)\n                        (                           # illegal sequence\n                          [\0-\u0006]                 # anything illegal\n                          |                           # alternate\n                          [\b-\u001A]                 # anything illegal\n                          |                           # alternate\n                          [\u001C-\u001F]                 # anything illegal\n                        )\n                    "], ["\n                        (?:                         # legal sequence\n                          (\\x1b\\\\)                    # ESC \\\n                          |                           # alternate\n                          (\\x07)                      # BEL (what xterm did)\n                        )\n                        |                           # alternate (second attempt)\n                        (                           # illegal sequence\n                          [\\x00-\\x06]                 # anything illegal\n                          |                           # alternate\n                          [\\x08-\\x1a]                 # anything illegal\n                          |                           # alternate\n                          [\\x1c-\\x1f]                 # anything illegal\n                        )\n                    "]));
                  }
                  this._osc_st.lastIndex = 0;
                  {
                      var match_1 = this._osc_st.exec(this._buffer);
                      if (match_1 === null) {
                          pkt.kind = PacketKind.Incomplete;
                          return pkt;
                      }
                      if (match_1[3]) {
                          pkt.kind = PacketKind.ESC;
                          pkt.text = this._buffer.slice(0, 1);
                          this._buffer = this._buffer.slice(1);
                          return pkt;
                      }
                  }
                  {
                      var match_2 = this._osc_st.exec(this._buffer);
                      if (match_2 === null) {
                          pkt.kind = PacketKind.Incomplete;
                          return pkt;
                      }
                      if (match_2[3]) {
                          pkt.kind = PacketKind.ESC;
                          pkt.text = this._buffer.slice(0, 1);
                          this._buffer = this._buffer.slice(1);
                          return pkt;
                      }
                  }
                  if (!this._osc_regex) {
                      this._osc_regex = rgx(__makeTemplateObject(["\n                        ^                           # beginning of line\n                                                    #\n                        \u001B]8;                    # OSC Hyperlink\n                        [ -:<-~]*       # params (excluding ;)\n                        ;                           # end of params\n                        ([!-~]{0,512})        # URL capture\n                        (?:                         # ST\n                          (?:\u001B\\)                  # ESC                           |                           # alternate\n                          (?:\u0007)                    # BEL (what xterm did)\n                        )\n                        ([ -~]+)              # TEXT capture\n                        \u001B]8;;                   # OSC Hyperlink End\n                        (?:                         # ST\n                          (?:\u001B\\)                  # ESC                           |                           # alternate\n                          (?:\u0007)                    # BEL (what xterm did)\n                        )\n                    "], ["\n                        ^                           # beginning of line\n                                                    #\n                        \\x1b\\]8;                    # OSC Hyperlink\n                        [\\x20-\\x3a\\x3c-\\x7e]*       # params (excluding ;)\n                        ;                           # end of params\n                        ([\\x21-\\x7e]{0,512})        # URL capture\n                        (?:                         # ST\n                          (?:\\x1b\\\\)                  # ESC \\\n                          |                           # alternate\n                          (?:\\x07)                    # BEL (what xterm did)\n                        )\n                        ([\\x20-\\x7e]+)              # TEXT capture\n                        \\x1b\\]8;;                   # OSC Hyperlink End\n                        (?:                         # ST\n                          (?:\\x1b\\\\)                  # ESC \\\n                          |                           # alternate\n                          (?:\\x07)                    # BEL (what xterm did)\n                        )\n                    "]));
                  }
                  var match = this._buffer.match(this._osc_regex);
                  if (match === null) {
                      pkt.kind = PacketKind.ESC;
                      pkt.text = this._buffer.slice(0, 1);
                      this._buffer = this._buffer.slice(1);
                      return pkt;
                  }
                  pkt.kind = PacketKind.OSCURL;
                  pkt.url = match[1];
                  pkt.text = match[2];
                  var rpos = match[0].length;
                  this._buffer = this._buffer.slice(rpos);
                  return pkt;
              }
          }
      };
      AnsiUp.prototype.ansi_to_html = function (txt) {
          this.append_buffer(txt);
          var blocks = [];
          while (true) {
              var packet = this.get_next_packet();
              if ((packet.kind == PacketKind.EOS)
                  || (packet.kind == PacketKind.Incomplete))
                  break;
              if ((packet.kind == PacketKind.ESC)
                  || (packet.kind == PacketKind.Unknown))
                  continue;
              if (packet.kind == PacketKind.Text)
                  blocks.push(this.transform_to_html(this.with_state(packet)));
              else if (packet.kind == PacketKind.SGR)
                  this.process_ansi(packet);
              else if (packet.kind == PacketKind.OSCURL)
                  blocks.push(this.process_hyperlink(packet));
          }
          return blocks.join("");
      };
      AnsiUp.prototype.with_state = function (pkt) {
          return { bold: this.bold, italic: this.italic, underline: this.underline, fg: this.fg, bg: this.bg, text: pkt.text };
      };
      AnsiUp.prototype.process_ansi = function (pkt) {
          var sgr_cmds = pkt.text.split(';');
          while (sgr_cmds.length > 0) {
              var sgr_cmd_str = sgr_cmds.shift();
              var num = parseInt(sgr_cmd_str, 10);
              if (isNaN(num) || num === 0) {
                  this.fg = this.bg = null;
                  this.bold = false;
                  this.italic = false;
                  this.underline = false;
              }
              else if (num === 1) {
                  this.bold = true;
              }
              else if (num === 3) {
                  this.italic = true;
              }
              else if (num === 4) {
                  this.underline = true;
              }
              else if (num === 22) {
                  this.bold = false;
              }
              else if (num === 23) {
                  this.italic = false;
              }
              else if (num === 24) {
                  this.underline = false;
              }
              else if (num === 39) {
                  this.fg = null;
              }
              else if (num === 49) {
                  this.bg = null;
              }
              else if ((num >= 30) && (num < 38)) {
                  this.fg = this.ansi_colors[0][(num - 30)];
              }
              else if ((num >= 40) && (num < 48)) {
                  this.bg = this.ansi_colors[0][(num - 40)];
              }
              else if ((num >= 90) && (num < 98)) {
                  this.fg = this.ansi_colors[1][(num - 90)];
              }
              else if ((num >= 100) && (num < 108)) {
                  this.bg = this.ansi_colors[1][(num - 100)];
              }
              else if (num === 38 || num === 48) {
                  if (sgr_cmds.length > 0) {
                      var is_foreground = (num === 38);
                      var mode_cmd = sgr_cmds.shift();
                      if (mode_cmd === '5' && sgr_cmds.length > 0) {
                          var palette_index = parseInt(sgr_cmds.shift(), 10);
                          if (palette_index >= 0 && palette_index <= 255) {
                              if (is_foreground)
                                  this.fg = this.palette_256[palette_index];
                              else
                                  this.bg = this.palette_256[palette_index];
                          }
                      }
                      if (mode_cmd === '2' && sgr_cmds.length > 2) {
                          var r = parseInt(sgr_cmds.shift(), 10);
                          var g = parseInt(sgr_cmds.shift(), 10);
                          var b = parseInt(sgr_cmds.shift(), 10);
                          if ((r >= 0 && r <= 255) && (g >= 0 && g <= 255) && (b >= 0 && b <= 255)) {
                              var c = { rgb: [r, g, b], class_name: 'truecolor' };
                              if (is_foreground)
                                  this.fg = c;
                              else
                                  this.bg = c;
                          }
                      }
                  }
              }
          }
      };
      AnsiUp.prototype.transform_to_html = function (fragment) {
          var txt = fragment.text;
          if (txt.length === 0)
              return txt;
          txt = this.escape_txt_for_html(txt);
          if (!fragment.bold && !fragment.italic && !fragment.underline && fragment.fg === null && fragment.bg === null)
              return txt;
          var styles = [];
          var classes = [];
          var fg = fragment.fg;
          var bg = fragment.bg;
          if (fragment.bold)
              styles.push('font-weight:bold');
          if (fragment.italic)
              styles.push('font-style:italic');
          if (fragment.underline)
              styles.push('text-decoration:underline');
          if (!this._use_classes) {
              if (fg)
                  styles.push("color:rgb(" + fg.rgb.join(',') + ")");
              if (bg)
                  styles.push("background-color:rgb(" + bg.rgb + ")");
          }
          else {
              if (fg) {
                  if (fg.class_name !== 'truecolor') {
                      classes.push(fg.class_name + "-fg");
                  }
                  else {
                      styles.push("color:rgb(" + fg.rgb.join(',') + ")");
                  }
              }
              if (bg) {
                  if (bg.class_name !== 'truecolor') {
                      classes.push(bg.class_name + "-bg");
                  }
                  else {
                      styles.push("background-color:rgb(" + bg.rgb.join(',') + ")");
                  }
              }
          }
          var class_string = '';
          var style_string = '';
          if (classes.length)
              class_string = " class=\"" + classes.join(' ') + "\"";
          if (styles.length)
              style_string = " style=\"" + styles.join(';') + "\"";
          return "<span" + style_string + class_string + ">" + txt + "</span>";
      };
      ;
      AnsiUp.prototype.process_hyperlink = function (pkt) {
          var parts = pkt.url.split(':');
          if (parts.length < 1)
              return '';
          if (!this._url_whitelist[parts[0]])
              return '';
          var result = "<a href=\"" + this.escape_txt_for_html(pkt.url) + "\">" + this.escape_txt_for_html(pkt.text) + "</a>";
          return result;
      };
      return AnsiUp;
  }());
  function rgx(tmplObj) {
      var subst = [];
      for (var _i = 1; _i < arguments.length; _i++) {
          subst[_i - 1] = arguments[_i];
      }
      var regexText = tmplObj.raw[0];
      var wsrgx = /^\s+|\s+\n|\s*#[\s\S]*?\n|\n/gm;
      var txt2 = regexText.replace(wsrgx, '');
      return new RegExp(txt2);
  }
  function rgxG(tmplObj) {
      var subst = [];
      for (var _i = 1; _i < arguments.length; _i++) {
          subst[_i - 1] = arguments[_i];
      }
      var regexText = tmplObj.raw[0];
      var wsrgx = /^\s+|\s+\n|\s*#[\s\S]*?\n|\n/gm;
      var txt2 = regexText.replace(wsrgx, '');
      return new RegExp(txt2, 'g');
  }
      Object.defineProperty(exports, "__esModule", { value: true });
      exports.default = AnsiUp;
  }));
  // micromodal: https://github.com/Ghosh/micromodal
  !function(e,t){"object"==typeof exports&&"undefined"!=typeof module?module.exports=t():"function"==typeof define&&define.amd?define(t):(e="undefined"!=typeof globalThis?globalThis:e||self).MicroModal=t()}(this,(function(){"use strict";function e(e,t){for(var o=0;o<t.length;o++){var n=t[o];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function t(e){return function(e){if(Array.isArray(e))return o(e)}(e)||function(e){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(e))return Array.from(e)}(e)||function(e,t){if(!e)return;if("string"==typeof e)return o(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return o(e,t)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function o(e,t){(null==t||t>e.length)&&(t=e.length);for(var o=0,n=new Array(t);o<t;o++)n[o]=e[o];return n}var n,i,a,r,s,l=(n=["a[href]","area[href]",'input:not([disabled]):not([type="hidden"]):not([aria-hidden])',"select:not([disabled]):not([aria-hidden])","textarea:not([disabled]):not([aria-hidden])","button:not([disabled]):not([aria-hidden])","iframe","object","embed","[contenteditable]",'[tabindex]:not([tabindex^="-"])'],i=function(){function o(e){var n=e.targetModal,i=e.triggers,a=void 0===i?[]:i,r=e.onShow,s=void 0===r?function(){}:r,l=e.onClose,c=void 0===l?function(){}:l,d=e.openTrigger,u=void 0===d?"data-micromodal-trigger":d,f=e.closeTrigger,h=void 0===f?"data-micromodal-close":f,v=e.openClass,g=void 0===v?"is-open":v,m=e.disableScroll,b=void 0!==m&&m,y=e.disableFocus,p=void 0!==y&&y,w=e.awaitCloseAnimation,E=void 0!==w&&w,k=e.awaitOpenAnimation,M=void 0!==k&&k,A=e.debugMode,C=void 0!==A&&A;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,o),this.modal=document.getElementById(n),this.config={debugMode:C,disableScroll:b,openTrigger:u,closeTrigger:h,openClass:g,onShow:s,onClose:c,awaitCloseAnimation:E,awaitOpenAnimation:M,disableFocus:p},a.length>0&&this.registerTriggers.apply(this,t(a)),this.onClick=this.onClick.bind(this),this.onKeydown=this.onKeydown.bind(this)}var i,a,r;return i=o,(a=[{key:"registerTriggers",value:function(){for(var e=this,t=arguments.length,o=new Array(t),n=0;n<t;n++)o[n]=arguments[n];o.filter(Boolean).forEach((function(t){t.addEventListener("click",(function(t){return e.showModal(t)}))}))}},{key:"showModal",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;if(this.activeElement=document.activeElement,this.modal.setAttribute("aria-hidden","false"),this.modal.classList.add(this.config.openClass),this.scrollBehaviour("disable"),this.addEventListeners(),this.config.awaitOpenAnimation){var o=function t(){e.modal.removeEventListener("animationend",t,!1),e.setFocusToFirstNode()};this.modal.addEventListener("animationend",o,!1)}else this.setFocusToFirstNode();this.config.onShow(this.modal,this.activeElement,t)}},{key:"closeModal",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,t=this.modal;if(this.modal.setAttribute("aria-hidden","true"),this.removeEventListeners(),this.scrollBehaviour("enable"),this.activeElement&&this.activeElement.focus&&this.activeElement.focus(),this.config.onClose(this.modal,this.activeElement,e),this.config.awaitCloseAnimation){var o=this.config.openClass;this.modal.addEventListener("animationend",(function e(){t.classList.remove(o),t.removeEventListener("animationend",e,!1)}),!1)}else t.classList.remove(this.config.openClass)}},{key:"closeModalById",value:function(e){this.modal=document.getElementById(e),this.modal&&this.closeModal()}},{key:"scrollBehaviour",value:function(e){if(this.config.disableScroll){var t=document.querySelector("body");switch(e){case"enable":Object.assign(t.style,{overflow:""});break;case"disable":Object.assign(t.style,{overflow:"hidden"})}}}},{key:"addEventListeners",value:function(){this.modal.addEventListener("touchstart",this.onClick),this.modal.addEventListener("click",this.onClick),document.addEventListener("keydown",this.onKeydown)}},{key:"removeEventListeners",value:function(){this.modal.removeEventListener("touchstart",this.onClick),this.modal.removeEventListener("click",this.onClick),document.removeEventListener("keydown",this.onKeydown)}},{key:"onClick",value:function(e){(e.target.hasAttribute(this.config.closeTrigger)||e.target.parentNode.hasAttribute(this.config.closeTrigger))&&(e.preventDefault(),e.stopPropagation(),this.closeModal(e))}},{key:"onKeydown",value:function(e){27===e.keyCode&&this.closeModal(e),9===e.keyCode&&this.retainFocus(e)}},{key:"getFocusableNodes",value:function(){var e=this.modal.querySelectorAll(n);return Array.apply(void 0,t(e))}},{key:"setFocusToFirstNode",value:function(){var e=this;if(!this.config.disableFocus){var t=this.getFocusableNodes();if(0!==t.length){var o=t.filter((function(t){return!t.hasAttribute(e.config.closeTrigger)}));o.length>0&&o[0].focus(),0===o.length&&t[0].focus()}}}},{key:"retainFocus",value:function(e){var t=this.getFocusableNodes();if(0!==t.length)if(t=t.filter((function(e){return null!==e.offsetParent})),this.modal.contains(document.activeElement)){var o=t.indexOf(document.activeElement);e.shiftKey&&0===o&&(t[t.length-1].focus(),e.preventDefault()),!e.shiftKey&&t.length>0&&o===t.length-1&&(t[0].focus(),e.preventDefault())}else t[0].focus()}}])&&e(i.prototype,a),r&&e(i,r),o}(),a=null,r=function(e){if(!document.getElementById(e))return console.warn("MicroModal: ❗Seems like you have missed %c'".concat(e,"'"),"background-color: #f8f9fa;color: #50596c;font-weight: bold;","ID somewhere in your code. Refer example below to resolve it."),console.warn("%cExample:","background-color: #f8f9fa;color: #50596c;font-weight: bold;",'<div class="modal" id="'.concat(e,'"></div>')),!1},s=function(e,t){if(function(e){e.length<=0&&(console.warn("MicroModal: ❗Please specify at least one %c'micromodal-trigger'","background-color: #f8f9fa;color: #50596c;font-weight: bold;","data attribute."),console.warn("%cExample:","background-color: #f8f9fa;color: #50596c;font-weight: bold;",'<a href="#" data-micromodal-trigger="my-modal"></a>'))}(e),!t)return!0;for(var o in t)r(o);return!0},{init:function(e){var o=Object.assign({},{openTrigger:"data-micromodal-trigger"},e),n=t(document.querySelectorAll("[".concat(o.openTrigger,"]"))),r=function(e,t){var o=[];return e.forEach((function(e){var n=e.attributes[t].value;void 0===o[n]&&(o[n]=[]),o[n].push(e)})),o}(n,o.openTrigger);if(!0!==o.debugMode||!1!==s(n,r))for(var l in r){var c=r[l];o.targetModal=l,o.triggers=t(c),a=new i(o)}},show:function(e,t){var o=t||{};o.targetModal=e,!0===o.debugMode&&!1===r(e)||(a&&a.removeEventListeners(),(a=new i(o)).showModal())},close:function(e){e?a.closeModalById(e):a.closeModal()}});return"undefined"!=typeof window&&(window.MicroModal=l),l}));  
  window.define = window.backupDefine; window.backupDefine = undefined;
  </script>
<script type="text/javascript">
  (function () {
    // forward keydown events so shortcuts can work in vscode, see:
    // https://github.com/microsoft/vscode/issues/65452#issuecomment-586485815
    if (window.parent.postMessage) {
      window.document.addEventListener('keydown', e => {
        const event = {
          type: "keydown",
          data: {
            altKey: e.altKey,
            code: e.code,
            ctrlKey: e.ctrlKey,
            isComposing: e.isComposing,
            key: e.key,
            location: e.location,
            metaKey: e.metaKey,
            repeat: e.repeat,
            shiftKey: e.shiftKey
          }
        };
        window.parent.postMessage(event, '*');
      });
    }
    // listen for execCommand messages
    window.addEventListener("message", function (event) {
      if (event.data.type === "devhost-exec-command") {
        window.document.execCommand(event.data.data);
      } 
    }, true);
    const logEntries = new Array(1000);
    logEntries.offset = 0;
    function recordLogEntry(entry) {
      logEntries[logEntries.offset++] = entry;
      logEntries.offset %= logEntries.length;
    }
    function getLogEntry(i) { // backwards, 0 is most recent
        return logEntries[(logEntries.offset - 1 - i + logEntries.length) % logEntries.length];
    }
    const protocol = window.location.protocol === "https:" ? "wss:" : "ws:";
    let path = window.location.pathname;
    if (!/\/$/.test(path)) path += "/";
    const devServerSocket = new WebSocket(protocol + "//" + window.location.host + path);
    let reloadPage = true;
    addEventListener("beforeunload", () => {
      // don't reload page in case of navigation events
      reloadPage = false;
    })
    devServerSocket.onopen = () => {
      console.log('Socket connection open. Listening for events.');
      // if the socket closes for any reason (e.g. this occurs in electron apps
      // when the computer suspends) then reload to reestablish the connection 
      devServerSocket.onclose = () => {
        if (reloadPage) {
          console.log('Socket connection closed. Reloading.');
          window.location.reload(true);
        }
      }
    };
    // append for errors that occur within the error window
    let lastError = 0;
    const kErrorWindow = 2500;
    function showError(msg) {
      const ansiUp = new AnsiUp
      const html = ansiUp.ansi_to_html(msg.trim());
      const display = document.getElementById("quarto-log-error-display");
      if (display.innerHTML && ((Date.now() - lastError) < kErrorWindow)) {
        display.innerHTML = display.innerHTML + "<br/>" +  html;
      } else {
        display.innerHTML = html
      }
      lastError = Date.now()
      MicroModal.show('quarto-log-error-modal', {
        awaitCloseAnimation: true,
        onClose: () => { display.innerHTML = ""; }
      });
      // post message to parent indicating we had an error
      if (window.parent.postMessage) {
        window.parent.postMessage({
          type: "error",
          msg: msg,
        }, "*");
      }
    }
    // see if there is already an error to show
    const renderError = document.getElementById("quarto-render-error");
    if (renderError) {
      showError(renderError.innerHTML.trim());
    }
    const normalizeTarget = (target) => {
      return target.replace(/\/index\.html/, "/")
    };
    devServerSocket.onmessage = (msg) => {
      if (msg.data.startsWith('reload')) {
        let target = normalizeTarget(msg.data.replace(/^reload/, ""));
        // prepend proxy path to target if we have one
        if (target) {
          const pathPrefix = 
            window.location.pathname.match(/^.*?\/p\/\w+\//) ||
            window.location.pathname.match(/^.*?\/user\/[\w\d]+\/proxy\/\d+\//);
          if (pathPrefix) {
            target = pathPrefix + target.slice(1);
          }
        }
        if (target && (target !== normalizeTarget(window.location.pathname))) {
          window.location.replace(target);
        } else {
          window.location.reload(true);
        }
      } else if (msg.data.startsWith('log:')) {
        const ansiUp = new AnsiUp
        const log = JSON.parse(msg.data.substr(4));
        recordLogEntry(log);
        if (log.levelName === "ERROR") {
          showError(log.msgFormatted)
        } else {
          // see if there is a knitr error to report
          const kExecutionHalted = "Execution halted";
          if (log.msg.indexOf(kExecutionHalted) !== -1) {
            // scan backwards for beginning of error
            const errorEntries = [getLogEntry(0).msgFormatted];
            for (let i=1; i<logEntries.length; i++) {
              const logEntry = getLogEntry(i);
              if (logEntry) {
                errorEntries.unshift(logEntry.msgFormatted);
                if (logEntry.msg.indexOf("Quitting from lines") !== -1) {
                  showError(errorEntries.join(""));
                  break;
                } else if (logEntry.msg.indexOf(kExecutionHalted) !== -1) {
                  break;
                }
              } else {
                break;
              }
            }
          }
        }
      }
    };
  })();
</script>

<script type="text/javascript">
  if (window.parent.postMessage) {
    // wait for message providing confirmation we are in a devhost
    window.addEventListener("message", function (event) {
      if (event.data.type === "devhost-init") {
        window.quartoDevhost = {
          openInputFile: function (line, column, highlight) {
            window.parent.postMessage({
              type: "openfile",
              file: "C:\Users\Conaf\Documents\BootCamp\estadistica\estadistica\0-PracticaFinal_EnResolución.qmd",
              line: line,
              column: column,
              highlight: highlight
            }, event.origin);
          }
        };
      } else if (event.data.type === "goback") {
        window.history.back()
      } else if (event.data.type === "goforward") {
        window.history.forward()
      }
    }, true);
    // notify host of navigation (e.g. for 'pop out' command)
    window.parent.postMessage({
      type: "navigate",
      href: window.location.href,
      file: "C:\Users\Conaf\Documents\BootCamp\estadistica\estadistica\0-PracticaFinal_EnResolución.qmd"
    }, "*");
  }
</script>
</body></html>